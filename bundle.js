(()=>{"use strict";var e={56(e,t,n){e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72(e){var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},o=[],l=0;l<e.length;l++){var s=e[l],d=r.base?s[0]+r.base:s[0],c=i[d]||0,u="".concat(d," ").concat(c);i[d]=c+1;var g=n(u),m={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==g)t[g].references++,t[g].updater(m);else{var p=a(m,r);r.byIndex=l,t.splice(l,0,{identifier:u,updater:p,references:1})}o.push(u)}return o}function a(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var i=r(e=e||[],a=a||{});return function(e){e=e||[];for(var o=0;o<i.length;o++){var l=n(i[o]);t[l].references--}for(var s=r(e,a),d=0;d<i.length;d++){var c=n(i[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}i=s}}},113(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},314(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(o[s]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);r&&o[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},540(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},552(e,t,n){n.d(t,{A:()=>l});var r=n(601),a=n.n(r),i=n(314),o=n.n(i)()(a());o.push([e.id,".cluster-filter-bar-header {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  gap: 1.2rem;\n  margin-bottom: 1.1rem;\n}\n.cluster-filter-bar-header h2 {\n  margin: 0;\n  font-size: 1.15rem;\n  flex-shrink: 0;\n}\n.cluster-filter-desc {\n  color: #b6c2d1;\n  font-size: 0.98rem;\n  margin-right: auto;\n}\n.cluster-filter-bar-header button {\n  margin-left: 0.5rem;\n  padding: 0.35rem 1.1rem;\n  font-size: 0.95rem;\n  border-radius: 999px;\n  border: 1px solid #334155;\n  background: #232b33;\n  color: #f1f5fa;\n  cursor: pointer;\n  transition: background 0.18s, border 0.18s;\n}\n.cluster-filter-bar-header button:hover {\n  background: #334155;\n  border-color: #64748b;\n}\n/* Cluster filter bar full-width section */\n.cluster-filter-bar {\n  width: 100%;\n  background: radial-gradient(circle at top left, #0f172a, #020617);\n  border-radius: 0.75rem;\n  border: 1px solid rgba(148, 163, 184, 0.35);\n  box-shadow: 0 18px 40px rgba(15, 23, 42, 0.7);\n  margin: 1.2rem 0 1.5rem 0;\n  padding: 1.2rem 2.2rem 1.2rem 2.2rem;\n  color: #f1f5fa;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n}\n\n.cluster-filter-bar h2 {\n  margin-top: 0;\n  font-size: 1rem;\n  letter-spacing: 0.03em;\n  text-transform: uppercase;\n  color: #9ca3af;\n}\n/* Spinner for loading indicator */\n.spinner {\n  display: inline-block;\n  width: 1.25em;\n  height: 1.25em;\n  border: 2.5px solid #4fd1c5;\n  border-top: 2.5px solid #232b33;\n  border-radius: 50%;\n  animation: spin 0.8s linear infinite;\n  vertical-align: middle;\n  margin-right: 0.7em;\n  background: none;\n}\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n.metadata-loading {\n  display: flex;\n  align-items: center;\n  font-size: 1.08rem;\n  color: #aee9e1;\n  min-height: 2.2em;\n  font-weight: 500;\n  letter-spacing: 0.01em;\n}\n.metadata-loading .loading-text {\n  display: inline-block;\n  color: #aee9e1;\n}\n/* Network metadata summary styles */\n\n.network-metadata {\n  background: none;\n  border: 1px solid rgba(148, 163, 184, 0.06);\n  border-radius: 10px;\n  padding: 1.05rem 1.4rem 1.2rem 1.4rem;\n  margin-bottom: 1.7rem;\n  box-shadow: 0 6px 18px rgba(2, 6, 23, 0.6);\n  max-width: 560px;\n  color: #f1f5fa;\n}\n.network-metadata h2 {\n  margin-top: 0;\n  font-size: 1.18rem;\n  margin-bottom: 0.6rem;\n  color: #f1f5fa;\n  font-weight: 600;\n  letter-spacing: 0.01em;\n}\n.metadata-wrapper {\n  display: grid;\n  grid-template-columns: minmax(320px, 420px) 1fr;\n  gap: 1.5rem 2rem;\n  align-items: start;\n  width: 100%;\n}\n.metadata-abstract p {\n  margin: 0;\n  color: #9ca3af;\n  line-height: 1.6;\n  font-size: 0.98rem;\n}\n\n.metadata-abstract a {\n  color: #60a5fa;\n  text-decoration: none;\n  transition: color 0.2s;\n}\n\n.metadata-abstract a:hover {\n  color: #93c5fd;\n  text-decoration: underline;\n}\n\n/* Responsive: stack on smaller screens */\n@media (max-width: 980px) {\n  .metadata-wrapper {\n    grid-template-columns: 1fr;\n  }\n  .metadata-abstract {\n    margin-top: 0.9rem;\n  }\n}\n\n.metadata-grid {\n  display: grid;\n  grid-template-columns: 1fr 120px;\n  background: #192132;\n  border-radius: 0.35rem;\n  border: 1px solid #232b3a;\n  box-shadow: none;\n  padding: 0.1rem 0.1rem 0.1rem 0.1rem;\n  margin-bottom: 0.2rem;\n  gap: 0;\n  font-size: 1.01rem;\n  overflow: hidden;\n}\n.metadata-grid div {\n  padding: 0.18rem 0;\n}\n.metadata-grid .metadata-header {\n  color: #bfc9d6;\n  background: #1e2636;\n  border-bottom: 1px solid #232b3a;\n  padding: 0.38rem 0.5rem 0.38rem 0.7rem;\n  margin-bottom: 0;\n  font-weight: 700;\n  font-size: 0.93rem;\n  letter-spacing: 0.06em;\n}\n.metadata-grid .metric-label {\n  color: #c7d0e0;\n  background: transparent;\n  border-bottom: 1px solid #232b3a;\n  padding: 0.28rem 0.5rem 0.28rem 0.7rem;\n  font-weight: 500;\n}\n.metadata-grid .metric-value {\n  color: #f3f6fa;\n  background: transparent;\n  border-bottom: 1px solid #232b3a;\n  padding: 0.28rem 0.7rem 0.28rem 0.5rem;\n  text-align: right;\n  font-family: 'JetBrains Mono', 'Fira Mono', 'Menlo', 'Consolas', monospace;\n  font-weight: 700;\n  font-variant-numeric: tabular-nums;\n}\n.metadata-grid .metric-label:last-child,\n.metadata-grid .metric-value:last-child {\n  border-bottom: none;\n}\n.metadata-grid .metric-label,\n.metadata-grid .metric-value {\n  transition: background 0.15s;\n}\n.metadata-grid .metric-label:hover,\n.metadata-grid .metric-value:hover {\n  background: #232b3a;\n}\n* {\n  box-sizing: border-box;\n}\n\nbody {\n  font-family: \"Segoe UI\", Tahoma, Geneva, Verdana, sans-serif;\n  margin: 0;\n  background: #11192a;\n  color: #222;\n}\n\nheader,\nfooter {\n  padding: 1.5rem 2rem;\n  background: #0b1120;\n  color: #fff;\n}\n\nfooter a {\n  color: #60a5fa;\n}\n\n.global-controls {\n  background: #111827;\n  color: #e2e8f0;\n  padding: 0.8rem 2rem;\n  display: flex;\n  flex-wrap: wrap;\n  gap: 1rem;\n  align-items: center;\n}\n.histogram {\n  width: 140px;\n  height: 48px;\n  display: flex;\n  align-items: flex-end;\n}\n\n.histogram svg {\n  width: 100%;\n  height: 100%;\n  overflow: visible;\n}\n\n.histogram rect {\n  fill: rgba(37, 99, 235, 0.35);\n}\n\n.histogram rect.active {\n  fill: #2563eb;\n}\n\n.global-controls select {\n  opacity: 0.5;\n  transition: opacity 0.2s ease, fill 0.2s ease;\n  margin-left: 0.5rem;\n  padding: 0.2rem 0.6rem;\n  border-radius: 4px;\n  fill: #2563eb;\n  opacity: 0.95;\n}\n\n.histogram line.hist-threshold {\n  stroke: #1d4ed8;\n  stroke-width: 2px;\n  stroke-linecap: round;\n}\n\n.global-controls p {\n  margin: 0;\n  font-size: 0.85rem;\n  color: #cbd5f5;\n}\n\nmain {\n  padding: 1.5rem 2rem;\n  display: flex;\n  flex-direction: column;\n  gap: 2rem;\n}\n\nsection {\n  background: #fff;\n  border-radius: 8px;\n  padding: 1.5rem;\n  box-shadow: 0 10px 25px rgba(15, 23, 42, 0.1);\n}\n\n.section-header {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  justify-content: space-between;\n  gap: 1rem;\n  margin-bottom: 1rem;\n}\n\n.controls {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  font-size: 0.9rem;\n}\n\n.controls input[type=\"range\"] {\n  width: 160px;\n}\n\n.controls select {\n  padding: 0.3rem 0.6rem;\n  border-radius: 4px;\n  border: 1px solid #cbd5f5;\n  background: #fff;\n  font-size: 0.9rem;\n}\n\n.controls button {\n  padding: 0.4rem 0.8rem;\n  border: none;\n  border-radius: 4px;\n  background: #2563eb;\n  color: #fff;\n  cursor: pointer;\n}\n\n.controls button:hover {\n  background: #1d4ed8;\n}\n\n.chart {\n  width: 100%;\n  min-height: 500px;\n}\n\n.section-description {\n  margin: 0 0 1rem 0;\n  color: #475569;\n  font-size: 0.9rem;\n  line-height: 1.4;\n}\n\nsvg {\n  width: 100%;\n  height: 100%;\n}\n\n.node circle {\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.link {\n  stroke: rgba(30, 58, 138, 0.4);\n}\n\n.link-language {\n  stroke: rgba(16, 185, 129, 0.5);\n}\n\n.link-author-author {\n  stroke: rgba(148, 163, 184, 0.4);\n}\n\n.legend {\n  font-size: 0.85rem;\n  fill: #555;\n}\n\n.legend-panel {\n  margin-top: 0.5rem;\n  display: inline-flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  font-size: 0.85rem;\n  color: #1f2937;\n}\n\n.legend-title {\n  font-weight: 600;\n}\n\n.legend-item {\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n}\n\n.legend-dot {\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  display: inline-block;\n}\n\n.legend-more {\n  color: #64748b;\n}\n\n.tooltip {\n  position: absolute;\n  padding: 0.5rem 0.8rem;\n  background: rgba(30, 41, 59, 0.95);\n  color: #fff;\n  border-radius: 4px;\n  pointer-events: none;\n  font-size: 0.85rem;\n  box-shadow: 0 8px 16px rgba(15, 23, 42, 0.4);\n  z-index: 99999;\n}\n\n/* Cluster View Styles */\nbody {\n  background: #0b1120;\n  color: #e5e7eb;\n}\n\nheader {\n  border-bottom: 1px solid #1f2937;\n}\n\nmain {\n  max-width: 1800px;\n  margin: 0 auto;\n  padding: 1rem 1.5rem 2rem;\n}\n\n.cluster-layout-wrapper {\n  display: grid;\n  grid-template-columns: minmax(0, 1fr) 360px;\n  gap: 1.25rem;\n  align-items: start;\n}\n\n.panel {\n  background: radial-gradient(circle at top left, #0f172a, #020617);\n  border-radius: 0.75rem;\n  border: 1px solid rgba(148, 163, 184, 0.35);\n  padding: 1rem;\n  box-shadow: 0 18px 40px rgba(15, 23, 42, 0.7);\n}\n\n.panel.filter-panel {\n  position: sticky;\n  top: 1.5rem;\n  align-self: start;\n}\n\n.panel h2 {\n  margin-top: 0;\n  font-size: 1rem;\n  letter-spacing: 0.03em;\n  text-transform: uppercase;\n  color: #9ca3af;\n}\n\n.chart {\n  background: radial-gradient(circle at center, #020617, #020617);\n  border-radius: 0.75rem;\n  border: 1px solid rgba(55, 65, 81, 0.7);\n  overflow: hidden;\n  width: 100%;\n}\n\n.cluster-controls {\n  margin-top: 1.75rem;\n  display: flex;\n  flex-direction: column;\n  gap: 1.25rem;\n}\n\n.control-section {\n  background: rgba(15, 23, 42, 0.85);\n  border: 1px solid rgba(55, 65, 81, 0.7);\n  border-radius: 0.85rem;\n  padding: 1rem 1.25rem;\n  box-shadow: 0 6px 18px rgba(2, 6, 23, 0.55);\n}\n\n.control-section h3 {\n  margin: 0 0 0.85rem;\n  font-size: 0.85rem;\n  letter-spacing: 0.08em;\n  text-transform: uppercase;\n  color: #9ca3af;\n}\n\n.control-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));\n  gap: 1rem 1.25rem;\n}\n\n.control-grid.triple {\n  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n}\n\n.control-card {\n  display: flex;\n  flex-direction: column;\n  gap: 0.35rem;\n}\n\n.control-actions {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  align-items: flex-start;\n  gap: 1rem;\n}\n\n.control-actions-left {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 0.4rem;\n}\n\n.control-actions-right {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  gap: 0.75rem;\n}\n\n.action-button-group {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 0.2rem;\n  text-align: center;\n}\n\n.icon-button {\n  width: 36px;\n  height: 36px;\n  border-radius: 999px;\n  border: 1px solid rgba(148, 163, 184, 0.6);\n  background: rgba(15, 23, 42, 0.85);\n  color: #e5e7eb;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: border-color 0.2s, color 0.2s;\n}\n\n.icon-button:hover {\n  border-color: rgba(34, 197, 94, 0.9);\n  color: #bbf7d0;\n}\n\n.action-description {\n  font-size: 0.7rem;\n  color: #9ca3af;\n  max-width: 120px;\n}\n\n.histogram {\n  width: 220px;\n  height: 90px;\n}\n\n.histogram-control {\n  display: flex;\n  flex-direction: column;\n  gap: 0.4rem;\n  min-width: 230px;\n}\n\n.histogram.brushable svg {\n  cursor: crosshair;\n}\n\n.histogram.large {\n  width: 280px;\n  height: 90px;\n}\n\n.centralization-block {\n  min-width: 300px;\n}\n\n.language-ratio-block {\n  min-width: 300px;\n}\n\n.search-control {\n  min-width: 240px;\n  position: relative;\n}\n\n.search-control input {\n  padding: 0.4rem 0.5rem;\n  border-radius: 0.4rem;\n  border: 1px solid rgba(148, 163, 184, 0.4);\n  background: rgba(15, 23, 42, 0.85);\n  color: #e5e7eb;\n}\n\n.search-control input:focus {\n  outline: none;\n  border-color: rgba(59, 130, 246, 0.8);\n  box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.5);\n}\n\n.search-suggestions {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  z-index: 20;\n  background: rgba(2, 6, 23, 0.98);\n  border: 1px solid rgba(51, 65, 85, 0.9);\n  border-radius: 0.4rem;\n  margin-top: 0.25rem;\n  max-height: 220px;\n  overflow-y: auto;\n  box-shadow: 0 10px 20px rgba(2, 6, 23, 0.65);\n  display: none;\n}\n\n.search-suggestions.visible {\n  display: block;\n}\n\n.search-suggestions button {\n  display: block;\n  width: 100%;\n  text-align: left;\n  padding: 0.35rem 0.5rem;\n  background: transparent;\n  border: none;\n  color: #e5e7eb;\n  font-size: 0.82rem;\n  cursor: pointer;\n}\n\n.search-suggestions button:hover,\n.search-suggestions button:focus {\n  background: rgba(59, 130, 246, 0.2);\n  outline: none;\n}\n\n.bar-chart {\n  width: min(420px, 100%);\n  height: 110px;\n  position: relative;\n  overflow-x: auto;\n  overflow-y: hidden;\n  padding-bottom: 0.25rem;\n}\n\n.bar-chart svg {\n  width: auto;\n  min-width: 420px;\n  max-width: none;\n  height: 100%;\n  display: block;\n}\n\n.selection-hint {\n  margin-top: 0.35rem;\n  font-size: 0.75rem;\n  color: #9ca3af;\n}\n\n.toggle-option {\n  display: flex;\n  align-items: center;\n  gap: 0.35rem;\n  font-size: 0.8rem;\n}\n\n.toggle-option input {\n  transform: scale(1.1);\n}\n\n.top-authors-button {\n  margin-top: 0.75rem;\n  padding: 0.5rem 1rem;\n  background: #1e293b;\n  color: #94a3b8;\n  border: 1px solid #334155;\n  border-radius: 6px;\n  font-size: 0.85rem;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.top-authors-button:hover {\n  background: #334155;\n  border-color: #475569;\n}\n\n.top-authors-button.active {\n  background: #0e7490;\n  color: #fff;\n  border-color: #0e7490;\n}\n\n.chart-header {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  align-items: flex-start;\n  gap: 0.75rem;\n  margin-bottom: 0.75rem;\n}\n\n.chart-search {\n  min-width: 260px;\n}\n\n.download-png-button {\n  padding: 0.5rem 1rem;\n  background: #1e293b;\n  color: #94a3b8;\n  border: 1px solid #334155;\n  border-radius: 6px;\n  font-size: 0.85rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  white-space: nowrap;\n}\n\n.download-png-button:hover {\n  background: #334155;\n  border-color: #475569;\n  color: #cbd5f1;\n}\n\n.selection-hint kbd {\n  background: #111827;\n  border-radius: 4px;\n  border: 1px solid #4b5563;\n  padding: 0.05rem 0.25rem;\n  font-size: 0.7rem;\n}\n\n.histogram rect {\n  fill: rgba(148, 163, 184, 0.4);\n}\n\n.histogram rect.active {\n  fill: #22c55e;\n}\n\n.bar-chart rect {\n  fill: rgba(148, 163, 184, 0.4);\n}\n\n.bar-chart rect.selected {\n  fill: #22c55e;\n}\n\n.hist-brush .selection {\n  fill: rgba(34, 197, 94, 0.2);\n  stroke: rgba(34, 197, 94, 0.85);\n}\n\n.hist-brush .handle {\n  fill: rgba(34, 197, 94, 0.85);\n  stroke: none;\n}\n\n.cluster-filter-grid {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 1.2rem 1.2rem;\n  margin-bottom: 1.2rem;\n  align-items: stretch;\n  justify-content: flex-start;\n}\n\n.author-detail-card {\n  border: 1px solid rgba(148, 163, 184, 0.35);\n  border-radius: 0.65rem;\n  padding: 0.75rem 0.85rem;\n  background: rgba(15, 23, 42, 0.85);\n  margin-bottom: 1rem;\n  box-shadow: 0 10px 25px rgba(2, 6, 23, 0.6);\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n.author-detail-header {\n  display: flex;\n  justify-content: space-between;\n  gap: 0.75rem;\n  align-items: center; /* vertically center the badge */\n}\n\n.author-detail-name {\n  font-size: 1rem;\n  margin: 0;\n  color: #f8fafc;\n}\n\n.author-detail-meta {\n  font-size: 0.75rem;\n  color: #94a3b8;\n  margin-top: 0.1rem;\n}\n\n.author-detail-badge {\n  padding: 0.2rem 0.5rem;\n  border-radius: 999px;\n  border: 1px solid rgba(148, 163, 184, 0.45);\n  font-size: 0.72rem;\n  color: #fef3c7;\n  background: rgba(234, 179, 8, 0.15);\n}\n\n.author-detail-metrics {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));\n  gap: 0.65rem;\n}\n\n.author-detail-metric {\n  border: 1px solid rgba(148, 163, 184, 0.25);\n  border-radius: 0.55rem;\n  padding: 0.45rem 0.55rem;\n  background: rgba(15, 23, 42, 0.65);\n}\n\n.author-detail-metric span {\n  display: block;\n  font-size: 0.68rem;\n  color: #94a3b8;\n}\n\n.author-detail-metric strong {\n  display: block;\n  font-size: 0.95rem;\n  color: #f8fafc;\n}\n\n.author-detail-section h3 {\n  margin: 0 0 0.35rem;\n  font-size: 0.78rem;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n  color: #9ca3af;\n}\n\n.author-detail-list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  display: flex;\n  flex-direction: column;\n  gap: 0.35rem;\n}\n\n.author-detail-list li {\n  display: flex;\n  justify-content: space-between;\n  font-size: 0.78rem;\n  color: #e5e7eb;\n}\n\n.author-detail-list span {\n  color: #94a3b8;\n}\n\n.author-detail-empty {\n  font-size: 0.75rem;\n  color: #94a3b8;\n  margin: 0;\n}\n\n.cluster-filter-card {\n  display: flex;\n  flex-direction: column;\n  min-width: 270px;\n  max-width: 320px;\n  flex: 1 1 270px;\n  text-align: left;\n  border: 1px solid rgba(148, 163, 184, 0.3);\n  border-radius: 0.65rem;\n  padding: 0.6rem 0.7rem;\n  background: linear-gradient(135deg, rgba(30,41,59,0.93) 80%, rgba(59,130,246,0.07) 100%);\n  cursor: pointer;\n  transition: border-color 0.2s, transform 0.2s;\n  color: #f1f5f9;\n  font-family: inherit;\n  font-size: 0.85rem;\n  box-sizing: border-box;\n  margin-bottom: 0;\n}\n\n.cluster-filter-card:hover {\n  border-color: rgba(59, 130, 246, 0.8);\n  transform: translateY(-1px);\n}\n\n.cluster-filter-card.selected {\n  border-color: rgba(34, 197, 94, 0.8);\n  box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.4);\n}\n\n.cluster-filter-row {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0.6rem;\n  font-size: 0.82rem;\n  color: #cbd5f5;\n}\n\n.cluster-filter-row strong {\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n}\n\n.cluster-filter-swatch {\n  width: 0.75rem;\n  height: 0.75rem;\n  border-radius: 999px;\n  box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.4);\n}\n\n.cluster-filter-languages {\n  margin-top: 0.35rem;\n  font-size: 0.72rem;\n  color: #9ca3af;\n}\n\n.cluster-filter-languages span {\n  display: inline-block;\n  margin-right: 0.4rem;\n  margin-bottom: 0.2rem;\n  padding: 0.15rem 0.4rem;\n  border-radius: 999px;\n  background: rgba(30, 64, 175, 0.35);\n  color: #e0f2fe;\n}\n\n.cluster-filter-actions {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.75rem;\n  font-size: 0.78rem;\n  color: #9ca3af;\n}\n\n.cluster-filter-actions button {\n  background: transparent;\n  border: 1px solid rgba(148, 163, 184, 0.5);\n  border-radius: 999px;\n  padding: 0.2rem 0.65rem;\n  color: #f3f4f6;\n  font-size: 0.72rem;\n  cursor: pointer;\n}\n\n.cluster-filter-actions button:hover {\n  border-color: rgba(34, 197, 94, 0.8);\n  color: #bbf7d0;\n}\n\n.chord-diagram-section {\n  margin-bottom: 1.5rem;\n  padding-bottom: 1.5rem;\n  border-bottom: 1px solid rgba(148, 163, 184, 0.2);\n}\n\n.chord-diagram-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 0.75rem;\n}\n\n.chord-diagram-section h2 {\n  margin: 0;\n}\n\n.maximize-button {\n  background: transparent;\n  border: 1px solid rgba(148, 163, 184, 0.3);\n  border-radius: 0.375rem;\n  padding: 0.375rem;\n  cursor: pointer;\n  color: #64748b;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.15s ease;\n}\n\n.maximize-button:hover {\n  background: rgba(148, 163, 184, 0.1);\n  border-color: rgba(148, 163, 184, 0.5);\n  color: #334155;\n}\n\n.maximize-button svg {\n  display: block;\n}\n\n.chord-diagram-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-height: 320px;\n  padding: 0.5rem;\n}\n\n.chord-diagram-container svg {\n  max-width: 100%;\n  height: auto;\n}\n\n.chord-diagram-hint {\n  margin-top: 0.5rem;\n  font-size: 0.72rem;\n  color: #9ca3af;\n  text-align: center;\n}\n\n/* Modal styles */\n.chord-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.85);\n  z-index: 9999;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem;\n  animation: fadeIn 0.2s ease;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n.chord-modal-content {\n  background: #1e293b;\n  border-radius: 1rem;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n  max-width: 95vw;\n  max-height: 95vh;\n  width: 800px;\n  display: flex;\n  flex-direction: column;\n  animation: slideUp 0.3s ease;\n}\n\n@keyframes slideUp {\n  from {\n    transform: translateY(20px);\n    opacity: 0;\n  }\n  to {\n    transform: translateY(0);\n    opacity: 1;\n  }\n}\n\n.chord-modal-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 1.25rem 1.5rem;\n  border-bottom: 1px solid rgba(148, 163, 184, 0.2);\n}\n\n.chord-modal-header h2 {\n  margin: 0;\n  color: #f1f5f9;\n  font-size: 1.25rem;\n  flex: 1;\n}\n\n.chord-modal-actions {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  margin-left: auto;\n}\n\n.chord-modal-close {\n  background: transparent;\n  border: 1px solid rgba(148, 163, 184, 0.3);\n  border-radius: 0.375rem;\n  padding: 0.375rem;\n  cursor: pointer;\n  color: #94a3b8;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.15s ease;\n}\n\n.chord-modal-close:hover {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: rgba(239, 68, 68, 0.5);\n  color: #ef4444;\n}\n\n.chord-modal-close svg {\n  display: block;\n}\n\n.chord-diagram-large {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem;\n  overflow: auto;\n}\n\n.chord-diagram-large svg {\n  max-width: 100%;\n  height: auto;\n}\n\n/* Radial Chart Styles */\n.radial-panel {\n  min-height: 500px;\n}\n\n.radial-chart-container {\n  width: 100%;\n  height: 400px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(15, 23, 42, 0.02);\n  border-radius: 0.5rem;\n  padding: 1rem;\n}\n\n.radial-chart-zoomed {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem;\n  overflow: auto;\n  min-height: 0;\n}\n\n.radial-chart-container svg,\n.radial-chart-zoomed svg {\n  max-width: 100%;\n  max-height: 100%;\n  height: auto;\n  width: auto;\n}\n\n.filter-status-bar {\n  background: rgba(15, 23, 42, 0.95);\n  border: 1px solid rgba(148, 163, 184, 0.3);\n  border-radius: 0.65rem;\n  padding: 0.75rem 1rem;\n  margin-bottom: 1rem;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 1rem;\n  box-shadow: 0 4px 12px rgba(2, 6, 23, 0.5);\n}\n\n.filter-status-content {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  flex-wrap: wrap;\n}\n\n.filter-status-label {\n  font-size: 0.8rem;\n  font-weight: 600;\n  color: #9ca3af;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n  white-space: nowrap;\n}\n\n.filter-status-items {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  flex-wrap: wrap;\n  flex: 1;\n}\n\n.filter-status-item {\n  display: inline-flex;\n  align-items: center;\n  gap: 0.35rem;\n  padding: 0.3rem 0.65rem;\n  background: rgba(59, 130, 246, 0.15);\n  border: 1px solid rgba(59, 130, 246, 0.4);\n  border-radius: 999px;\n  font-size: 0.75rem;\n  color: #bfdbfe;\n  white-space: nowrap;\n}\n\n.filter-status-item.filter-status-none {\n  background: transparent;\n  border: none;\n  color: #6b7280;\n  font-style: italic;\n}\n\n.filter-status-item.filter-type-language {\n  background: rgba(251, 146, 60, 0.15);\n  border-color: rgba(251, 146, 60, 0.4);\n  color: #fed7aa;\n}\n\n.filter-status-item.filter-type-cluster {\n  background: rgba(168, 85, 247, 0.15);\n  border-color: rgba(168, 85, 247, 0.4);\n  color: #e9d5ff;\n}\n\n.filter-status-item.filter-type-weight {\n  background: rgba(34, 197, 94, 0.15);\n  border-color: rgba(34, 197, 94, 0.4);\n  color: #bbf7d0;\n}\n\n.filter-status-item.filter-type-languagecentrality {\n  background: rgba(244, 114, 182, 0.15);\n  border-color: rgba(244, 114, 182, 0.4);\n  color: #fbcfe8;\n}\n\n.filter-status-item.filter-type-selection {\n  background: rgba(234, 179, 8, 0.15);\n  border-color: rgba(234, 179, 8, 0.4);\n  color: #fef3c7;\n}\n\n.filter-status-item.filter-type-option {\n  background: rgba(100, 116, 139, 0.15);\n  border-color: rgba(100, 116, 139, 0.4);\n  color: #cbd5e1;\n}\n\n.filter-status-item-remove {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 18px;\n  height: 18px;\n  border-radius: 999px;\n  background: transparent; /* inherit badge background */\n  border: 1px solid rgba(255,255,255,0.06);\n  color: inherit; /* use badge text color */\n  cursor: pointer;\n  font-size: 11px;\n  line-height: 1;\n  transition: background 0.12s, transform 0.08s, border-color 0.12s;\n}\n\n.filter-status-item-remove:hover {\n  background: rgba(255, 255, 255, 0.04);\n  transform: translateY(-1px);\n  border-color: rgba(255,255,255,0.12);\n}\n\n.filter-status-item-remove:focus {\n  outline: none;\n  box-shadow: 0 0 0 3px rgba(59,130,246,0.12);\n}\n\n.filter-status-clear {\n  padding: 0.35rem 0.75rem;\n  background: rgba(239, 68, 68, 0.15);\n  border: 1px solid rgba(239, 68, 68, 0.4);\n  border-radius: 0.4rem;\n  color: #fecaca;\n  font-size: 0.75rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n  white-space: nowrap;\n}\n\n.filter-status-clear:hover {\n  background: rgba(239, 68, 68, 0.25);\n  border-color: rgba(239, 68, 68, 0.6);\n}\n\n.filter-status-clear:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.top-panel {\n  background: radial-gradient(circle at top left, #0f172a, #020617);\n  border-radius: 0.85rem;\n  border: 1px solid rgba(148, 163, 184, 0.35);\n  box-shadow: 0 18px 40px rgba(15, 23, 42, 0.7);\n  margin: 2.2rem auto 2.2rem auto;\n  padding: 2.2rem 2.6rem 2.2rem 2.6rem;\n  color: #f1f5fa;\n  max-width: 1800px;\n  width: 100%;\n}\n.top-panel h1 {\n  font-size: 2.1rem;\n  font-weight: 700;\n  margin: 0 0 1.2rem 0;\n  color: #f1f5fa;\n  letter-spacing: 0.01em;\n  text-shadow: 0 2px 12px rgba(15,23,42,0.18);\n}\n@media (max-width: 900px) {\n  .top-panel {\n    padding: 1.2rem 0.7rem 1.2rem 0.7rem;\n  }\n  .top-panel h1 {\n    font-size: 1.3rem;\n  }\n}\n\n.site-footer {\n  color: #7b879a;\n  border-top: 1px solid #232b3a;\n  padding: 1.2rem 0 0.7rem 0;\n  margin-top: 2.2rem;\n  font-size: 0.93rem;\n  text-align: center;\n}\n.footer-content {\n  max-width: 900px;\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 0.4rem;\n}\n.footer-title {\n  font-size: 0.99rem;\n  color: #a3adc2;\n  margin-bottom: 0.1rem;\n  font-weight: 400;\n}\n.footer-meta {\n  font-size: 0.91rem;\n  color: #7b879a;\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.4em;\n  align-items: center;\n  justify-content: center;\n  font-weight: 400;\n}\n.footer-meta a {\n  color: #8bb6d6;\n  text-decoration: none;\n  font-weight: 400;\n  transition: color 0.15s;\n}\n.footer-meta a:hover {\n  color: #38bdf8;\n  text-decoration: underline;\n}\n.footer-sep {\n  color: #232b3a;\n  margin: 0 0.4em;\n}\n@media (max-width: 600px) {\n  .footer-content {\n    font-size: 0.89rem;\n    padding: 0 0.5rem;\n  }\n  .footer-title {\n    font-size: 0.91rem;\n  }\n}\n",""]);const l=o},601(e){e.exports=function(e){return e[1]}},659(e){var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,a&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var r=n(72),a=n.n(r),i=n(825),o=n.n(i),l=n(659),s=n.n(l),d=n(56),c=n.n(d),u=n(540),g=n.n(u),m=n(113),p=n.n(m),h=n(552),f={};function b(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toString()}function y(e){e.style("opacity",0)}f.styleTagTransform=p(),f.setAttributes=c(),f.insert=s().bind(null,"head"),f.domAPI=o(),f.insertStyleElement=g(),a()(h.A,f),h.A&&h.A.locals&&h.A.locals;const x="https://api.allorigins.win/get?url=https%3A//github.com/lisateichmann/dnb_trans_networks/releases/download/v1.0/author_author_graph.json",v=["#f87171","#facc15","#38bdf8","#fb923c","#fde047","#93c5fd","#f472b6","#34d399","#c084fc","#fed7aa","#4ade80","#a5b4fc"],w=["outer","periphery","core"],k=["Hesse,Hermann","Kafka,Franz","Goethe,JohannWolfgangvon","Mann,Thomas","Bernhard,Thomas","Handke,Peter","Rilke,RainerMaria","Zweig,Stefan","Konsalik,HeinzG.","Roth,Joseph","Courths-Mahler,Hedwig","Remarque,ErichMaria","Link,Charlotte","Grass,Günter","Böll,Heinrich","Brecht,Bertolt","Jelinek,Elfriede","Dürrenmatt,Friedrich","Walser,Robert","Hoffmann,E.T.A."],N={core:8,periphery:3.5},z={outer:"Outer periphery",periphery:"Periphery",core:"Core"},I={core:"#fbbf24",periphery:"#60a5fa",outer:"#64748b"};let $=null;const E=[.4,4];function C(e){if(!$){const t=[...e].sort();$=d3.scaleOrdinal().domain(t).range(d3.schemeSet3)}return $}let M={...N};function S(e){return e?"number"==typeof e.centralizationScoreNormalized?e.centralizationScoreNormalized:"number"==typeof e.centralizationScore?e.centralizationScore:NaN:NaN}function F(e){return e?String(e).trim().toLowerCase().replace(/[^a-z0-9_\-]/gi,""):""}function A(){return{...M}}function R(e){if(!e)return;const t=A();M={core:Number.isFinite(e.core)?e.core:t.core,periphery:Number.isFinite(e.periphery)?e.periphery:t.periphery},M.core<=M.periphery&&(M.core=M.periphery+.01)}function L(e){if(!e.selectedIds||0===e.selectedIds.size)return void(e.selectionVisibleNodes=null);const t=new Set(e.selectedIds);e.onlySharedSelectionLinks&&e.selectedIds.size>1||e.links.forEach(n=>{if(!n.visible)return;const r=n.sourceNode?.id,a=n.targetNode?.id;r&&a&&(e.selectedIds.has(r)||e.selectedIds.has(a))&&(t.add(r),t.add(a))}),e.selectionVisibleNodes=t}function T(e){if(e._languageSet)return e._languageSet;const t=new Set;return(e.languages||[]).forEach(e=>{const n=F(e.language);n&&t.add(n)}),e._languageSet=t,t}function B(e){return e?.languageCommunity}const j={degree:"Degree centrality",closeness:"Closeness centrality",betweenness:"Betweenness centrality",eigenvector:"Eigenvector centrality",pagerank:"PageRank",strength:"Strength"};function P(e,t){const n=Math.min(e,t),r=Math.max(360,n/2-10),a=Math.max(18,.04*r),i=r-a,o=a+.38*i,l=a+.74*i;return{centerX:e/2,centerY:t/2,maxRadius:r,minRadius:a,tiers:[{tier:"outer",radius:r,innerRadius:l},{tier:"periphery",radius:l,innerRadius:o},{tier:"core",radius:o,innerRadius:a}]}}function V(e,t=A()){return"core"===e?`≥ ${t.core.toFixed(1)}`:"periphery"===e?`${t.periphery.toFixed(1)}–${t.core.toFixed(1)}`:`< ${t.periphery.toFixed(1)}`}function O(e,t){const n=null==e?"":String(e),r=null==t?"":String(t);return n<r?`${n}||${r}`:`${r}||${n}`}function _(e,t,n){const r={core:new Map,periphery:new Map,outer:new Map},a={core:[],periphery:[],outer:[]};e.forEach(e=>{const t=S(e);e._centralizationValue=Number.isFinite(t)?t:Number.NaN;const i=null!=e[n]?String(e[n]):"";let o="outer",l=i||"_noise";o="0"===i?"core":"1"===i||"2"===i?"periphery":"outer",l=i||"_noise",r[o].has(l)||r[o].set(l,[]),r[o].get(l).push(e),Number.isFinite(e._centralizationValue)&&a[o].push(e._centralizationValue)});const i={};t.tiers.forEach(e=>{i[e.tier]={inner:e.innerRadius??t.minRadius,outer:e.radius??t.maxRadius}});const o=2*t.centerX,l=2*t.centerY,s=t.tiers.find(e=>"core"===e.tier);s.innerRadius??t.minRadius,s.radius??t.maxRadius,e.forEach(e=>{const n=e.languageCommunity?e.languageCommunity:"";e._centralizationTier="1"===n?"core":"2"===n?"periphery":"outer";const r=t.tiers.find(t=>t.tier===e._centralizationTier);if(r){const n=r.innerRadius??t.minRadius,a=r.radius??t.maxRadius,i=n+Math.random()*(a-n),o=2*Math.random()*Math.PI;e.x=e._initialX=t.centerX+i*Math.cos(o),e.y=e._initialY=t.centerY+i*Math.sin(o)}else e.x=e._initialX=Math.random()*o,e.y=e._initialY=Math.random()*l})}function U(e,t){const n=F(e);return!n||!Number.isFinite(t)||t<=0?null:{language:e,ratio:t,key:n}}function W(e,t,n={}){const{binFormatter:r,onHover:a,onBins:i,interactive:o=!1,initialRange:l=null,onRangeChange:s}=n,d=d3.select(e),c=d.node();if(d.selectAll("*").remove(),!c)return;const u=Math.max(140,c.clientWidth||c.offsetWidth||160),g=Math.max(40,c.clientHeight||c.offsetHeight||60);if(!t.length)return void d.append("svg").attr("width",u).attr("height",g);let[m,p]=d3.extent(t);if(!Number.isFinite(m)||!Number.isFinite(p))return;m===p&&(p=m+1);const h=Math.min(20,Math.max(4,Math.round(Math.sqrt(t.length))))||10,f=d3.bin().domain([m,p]).thresholds(h)(t);"function"==typeof i&&i(f,{minValue:m,maxValue:p});const b=g-6-4,y=d3.scaleLinear().domain([m,p]).range([0,u]),x=d3.max(f,e=>e.length)||1,v=d3.scaleLinear().domain([0,x]).range([b,0]),w=d.append("svg").attr("width",u).attr("height",g),k=w.append("g").attr("transform","translate(0, 6)").selectAll("rect").data(f).join("rect").attr("x",e=>y(e.x0)+.5).attr("y",e=>v(e.length)).attr("width",e=>Math.max(1,y(e.x1)-y(e.x0)-1)).attr("height",e=>Math.max(1,b-v(e.length)));"function"==typeof r&&k.attr("title",(e,t)=>r(e,t,f)),"function"==typeof a&&k.on("mouseenter",(e,t)=>a(t,f,e)).on("mousemove",(e,t)=>a(t,f,e)).on("mouseleave",e=>a(null,f,e));const N=e=>{if(!Array.isArray(e)||2!==e.length)return[m,p];const t=Math.max(m,Math.min(p,e[0]));return[t,Math.max(t+Number.EPSILON,Math.min(p,e[1]))]},z=e=>{const[t,n]=N(e);k.classed("active",e=>(e.x1??p)>t&&(e.x0??m)<n)};if(o){let e=N(l||[m,p]);z(e);const t=d3.brushX().extent([[0,6],[u,6+b]]).on("brush end",t=>{if(t.selection){const[n,r]=t.selection;e=N([y.invert(n),y.invert(r)])}else e=[m,p];z(e),"function"==typeof s&&s(e.slice(),{bins:f,minValue:m,maxValue:p})}),n=w.append("g").attr("class","hist-brush");n.call(t),n.call(t.move,e.map(e=>y(e)))}}function D(e,t){const n=Number.isFinite(t?.min)?t.min:0,r=Number.isFinite(t?.max)?t.max:Number.POSITIVE_INFINITY;e.weightRange={min:n,max:r};const a=new Set;e.links.forEach(e=>{const t=Number(e.weight)||0,i=t>=n&&t<=r;e.visible=i,i&&(a.add(e.sourceNode.id),a.add(e.targetNode.id))}),e.nodes.forEach(e=>{e.visible=a.has(e.id)})}function Y(e){const t=e.clusterFilter&&e.clusterFilter.size;let n=!t||!e.focusNodeId;const r=[];e.nodes.forEach(a=>{const i=(e=>{const t=B(e);if(null===t)return null;const n=String(t),r="0->1->2"===n,a=n.includes("->");return r?"3-bridges":a?"2-bridges":n})(a);a.clusterVisible=!t||null!==i&&e.clusterFilter.has(i),a.clusterVisible&&a.id===e.focusNodeId&&(n=!0),!a.clusterVisible&&e.selectedIds?.has(a.id)&&r.push(a.id)}),r.forEach(t=>e.selectedIds.delete(t)),n||(e.focusNodeId=null,e.focusVisible=null),t&&e.hoverNode&&!1===e.hoverNode.clusterVisible&&(e.hoverNode=null,y(e.tooltip))}function H(e,t={}){const{onLanguageClick:n,container:r="#chordDiagram",width:a=320,height:i=320}=t,o=d3.select(r);if(o.selectAll("*").remove(),!e||!e.nodes||!e.links)return void o.append("p").style("color","#9ca3af").style("font-size","0.75rem").text("No language flow data available.");let l=d3.select("body").select(".chord-diagram-tooltip");l.empty()&&(l=d3.select("body").append("div").attr("class","tooltip chord-diagram-tooltip").style("position","absolute").style("padding","0.5rem 0.8rem").style("background","rgba(30, 41, 59, 0.95)").style("color","#fff").style("border-radius","4px").style("pointer-events","none").style("font-size","0.85rem").style("box-shadow","0 8px 16px rgba(15, 23, 42, 0.4)").style("z-index","99999").style("opacity",0));const s=a,d=i,c=.45*Math.min(s,d),u=c-20,g=new Set(["ger","mul"]),m=new Map;e.nodes.forEach(e=>{m.set(e.id,e.totalWeight||0)});const p=Array.from(m.entries()).sort((e,t)=>t[1]-e[1]).map(e=>e[0]),h=[...p.slice(0,15),...p.filter(e=>g.has(e))].filter((e,t,n)=>n.indexOf(e)===t),f=(new Set(h),new Map(h.map((e,t)=>[e,t]))),y=Array(h.length).fill(0).map(()=>Array(h.length).fill(0)),x=new Map;e.links.forEach(e=>{const t=f.get(e.source),n=f.get(e.target);void 0!==t&&void 0!==n&&(y[t][n]=e.weight||0,x.set(e.source,(x.get(e.source)||0)+1),x.set(e.target,(x.get(e.target)||0)+1))});const v=new Map;h.forEach((e,t)=>{let n=0,r=0;y[t].forEach((e,t)=>{e>0&&(n+=e,r+=e*t)}),y.forEach((e,a)=>{const i=e[t];i>0&&(n+=i,r+=i*a)}),v.set(t,n>0?r/n:t)});const w=h.map((e,t)=>({lang:e,idx:t,strength:v.get(t)||t})).sort((e,t)=>e.strength-t.strength).map(e=>e.idx),k=w.map(e=>w.map(t=>y[e][t])),N=w.map(e=>h[e]),z=o.append("svg").attr("width",s).attr("height",d).attr("viewBox",[-s/2,-d/2,s,d]),I=d3.chord().padAngle(.04).sortSubgroups(d3.descending).sortChords(d3.descending),$=d3.arc().innerRadius(u).outerRadius(c),E=d3.ribbon().radius(u),M=C(N),S=I(k),A=z.append("g").selectAll("g").data(S.groups).join("g");A.append("path").attr("fill",e=>M(N[e.index])).attr("d",$).attr("stroke","none").style("cursor","pointer").attr("class","chord-arc").attr("data-lang-index",e=>e.index).on("mouseenter",function(t,n){const r=N[n.index],a=e.nodes.find(e=>e.id===r),i=new Set;S.forEach(e=>{e.source.index===n.index&&i.add(N[e.target.index]),e.target.index===n.index&&i.add(N[e.source.index])}),z.selectAll(".chord-arc").each(function(e){const t=N[e.index];e.index===n.index||i.has(t)}).attr("fill-opacity",function(e){const t=N[e.index];return e.index===n.index||i.has(t)?1:.15}).attr("stroke-width",function(e){return e.index===n.index?2:1}).attr("stroke",function(e){return e.index===n.index?"#fbbf24":"rgba(15, 23, 42, 0.3)"}),z.selectAll(".chord-label").style("opacity",function(e){const t=N[e.index];return e.index===n.index||i.has(t)?1:.2}).style("font-weight",function(e){return e.index===n.index?"bold":"normal"}),z.selectAll(".ribbon").style("opacity",e=>e.source.index===n.index||e.target.index===n.index?1:.15);const o=a?.authorCount||0,s=i.size;let d=`<strong>${r.toUpperCase()}</strong><br/>`;d+=`${b(n.value)} translations<br/>`,d+=`${b(o)} authors<br/>`,d+=`${s} connected language${1!==s?"s":""}<br/>`,d+='<em style="font-size: 0.85em; color: #cbd5e1;">Click to filter network</em>',l.style("opacity",1).html(d).style("left",`${t.pageX+12}px`).style("top",`${t.pageY+12}px`)}).on("mouseleave",function(){z.selectAll(".ribbon").style("opacity",1),z.selectAll(".chord-arc").attr("fill-opacity",1).attr("stroke-width",1).attr("stroke","rgba(15, 23, 42, 0.3)"),z.selectAll(".chord-label").style("opacity",1).style("font-weight","normal"),l.style("opacity",0)}).on("click",function(e,t){const r=F(N[t.index]);"function"==typeof n&&n(r,e)}),A.append("title").text(t=>{const n=N[t.index],r=e.nodes.find(e=>e.id===n),a=r?.authorCount||0;return`${n.toUpperCase()}\n${b(t.value)} translations\n${b(a)} authors`}),A.append("text").each(e=>{e.angle=(e.startAngle+e.endAngle)/2}).attr("dy","0.35em").attr("transform",e=>`\n      rotate(${180*e.angle/Math.PI-90})\n      translate(${c+8})\n      ${e.angle>Math.PI?"rotate(180)":""}\n    `).attr("text-anchor",e=>e.angle>Math.PI?"end":"start").text(e=>N[e.index].toUpperCase()).style("font-size","9px").style("fill","#e5e7eb").style("pointer-events","none").attr("class","chord-label"),z.append("g").attr("fill-opacity",1).selectAll("path").data(S).join("path").attr("d",E).attr("fill",e=>M(N[e.source.index])).attr("stroke","none").attr("class","ribbon").style("cursor","pointer").on("mouseenter",function(e,t){z.selectAll(".ribbon").style("opacity",.15),d3.select(this).style("opacity",1);const n=N[t.source.index],r=N[t.target.index],a=k[t.source.index][t.target.index];l.style("opacity",1).html(`<strong>${n.toUpperCase()}</strong> ↔ <strong>${r.toUpperCase()}</strong><br/>${b(a)} shared author${1!==a?"s":""}`).style("left",`${e.pageX+12}px`).style("top",`${e.pageY+12}px`)}).on("mousemove",function(e){l.style("left",`${e.pageX+12}px`).style("top",`${e.pageY+12}px`)}).on("mouseleave",function(){z.selectAll(".ribbon").style("opacity",1),l.style("opacity",0)})}function K(e,t={}){const{container:n="#radialChart",width:r=400,height:a=400}=t,i=d3.select(n);if(i.selectAll("*").remove(),!e||!e.nodes)return void i.append("p").style("color","#9ca3af").style("font-size","0.75rem").text("No language data available.");let o=d3.select("body").select(".radial-tooltip");o.empty()&&(o=d3.select("body").append("div").attr("class","tooltip radial-tooltip").style("position","absolute").style("padding","0.5rem 0.8rem").style("background","rgba(30, 41, 59, 0.95)").style("color","#fff").style("border-radius","4px").style("pointer-events","none").style("font-size","0.85rem").style("box-shadow","0 8px 16px rgba(15, 23, 42, 0.4)").style("z-index","99999").style("opacity",0));const l=r,s=a,d=Math.min(l,s)/2*.9,c=.6*d,u=new Set(["ger","mul"]),g=e.nodes.filter(e=>"deu"!==e.id&&e.totalWeight>0).sort((e,t)=>t.totalWeight-e.totalWeight),m=[...g.slice(0,30),...g.filter(e=>u.has(e.id))].filter((e,t,n)=>n.findIndex(t=>t.id===e.id)===t).sort((e,t)=>t.totalWeight-e.totalWeight),p=C(e.nodes.map(e=>e.id)),h=d3.pie().value(e=>e.totalWeight).padAngle(.01).sort(null)(m),f=i.append("svg").attr("width",l).attr("height",s).attr("viewBox",[-l/2,-s/2,l,s]),y=d3.arc().innerRadius(c).outerRadius(d),x=d3.arc().innerRadius(30).outerRadius(c);f.selectAll(".radial-ribbon").data(h).join("path").attr("class","radial-ribbon").attr("d",x).attr("fill",e=>p(e.data.id)).attr("opacity",.5).attr("stroke","none").attr("data-lang-id",e=>e.data.id).style("cursor","pointer").on("mouseenter",function(e,t){f.selectAll(".radial-ribbon").attr("opacity",.15),f.selectAll(".radial-arc").attr("opacity",.3),d3.select(this).attr("opacity",.9),f.selectAll(`.radial-arc[data-lang-id="${t.data.id}"]`).attr("opacity",1),o.style("opacity",1).html(`<strong>${t.data.id.toUpperCase()}</strong><br/>${b(t.data.authorCount)} authors<br/>${b(t.data.totalWeight)} translations`).style("left",`${e.pageX+12}px`).style("top",`${e.pageY+12}px`)}).on("mousemove",function(e){o.style("left",`${e.pageX+12}px`).style("top",`${e.pageY+12}px`)}).on("mouseleave",function(){f.selectAll(".radial-ribbon").attr("opacity",.5),f.selectAll(".radial-arc").attr("opacity",1),o.style("opacity",0)}),f.selectAll(".radial-arc").data(h).join("path").attr("class","radial-arc").attr("d",y).attr("fill",e=>p(e.data.id)).attr("opacity",1).attr("stroke","none").attr("data-lang-id",e=>e.data.id).style("cursor","pointer").on("mouseenter",function(e,t){f.selectAll(".radial-ribbon").attr("opacity",.15),f.selectAll(".radial-arc").attr("opacity",.3),d3.select(this).attr("opacity",1),f.selectAll(`.radial-ribbon[data-lang-id="${t.data.id}"]`).attr("opacity",.9),o.style("opacity",1).html(`<strong>${t.data.id.toUpperCase()}</strong><br/>${b(t.data.authorCount)} authors<br/>${b(t.data.totalWeight)} translations`).style("left",`${e.pageX+12}px`).style("top",`${e.pageY+12}px`)}).on("mousemove",function(e){o.style("left",`${e.pageX+12}px`).style("top",`${e.pageY+12}px`)}).on("mouseleave",function(){f.selectAll(".radial-ribbon").attr("opacity",.5),f.selectAll(".radial-arc").attr("opacity",1),o.style("opacity",0)}),f.selectAll(".radial-label").data(h).join("text").attr("class","radial-label").attr("transform",e=>{const t=(e.startAngle+e.endAngle)/2;return`translate(${Math.cos(t-Math.PI/2)*(d+10)},${Math.sin(t-Math.PI/2)*(d+10)})`}).attr("text-anchor",e=>(e.startAngle+e.endAngle)/2>Math.PI?"end":"start").attr("dominant-baseline","middle").attr("font-size","9px").attr("fill","#e5e7eb").attr("font-weight","500").style("pointer-events","none").text(e=>e.data.id.toUpperCase());const v=f.append("g").attr("class","german-center");v.append("circle").attr("r",30).attr("fill","rgba(15, 23, 42, 0.85)").attr("stroke","none"),v.append("text").attr("text-anchor","middle").attr("dominant-baseline","middle").attr("font-size","14px").attr("font-weight","bold").attr("fill","#e5e7eb").text("GER"),v.append("text").attr("y",45).attr("text-anchor","middle").attr("font-size","9px").attr("fill","#94a3b8").attr("font-weight","600").text("Source Language")}(async function(){const e=d3.select("#clusterChart"),t=e.node().getBoundingClientRect(),n=t.width||1100,r=t.height||640,a=window.devicePixelRatio||1,i=e.append("canvas").attr("width",n*a).attr("height",r*a).style("width",`${n}px`).style("height",`${r}px`).node(),o=i.getContext("2d");o.scale(a,a);const l=d3.select("body").append("div").attr("class","tooltip").style("opacity",0),s=d3.scaleOrdinal(v),d=document.getElementById("authorAuthorHistogram"),c=document.getElementById("authorAuthorRangeValue"),u=document.getElementById("centralizationHistogram"),g=document.getElementById("centralizationRangeValue"),m=document.getElementById("centralizationStats"),p=document.getElementById("authorSearchInput"),h=document.getElementById("authorSearchSuggestions"),f=document.getElementById("languageRatioStats"),$=document.getElementById("languageRatioBarChart"),C=document.getElementById("clearSelection"),M=document.getElementById("showEdgesToggle"),q=document.getElementById("translationOpacityToggle"),X=document.getElementById("sharedEdgesOnly"),G=document.getElementById("clusterLanguageFilter"),J=document.getElementById("resetClusterFilter"),Z=document.getElementById("authorDetailPanel"),Q=document.getElementById("metadataGrid"),ee=await async function(){const e=await fetch(x);if(!e.ok)throw new Error(`Failed to load ${x}`);const t=await e.json();return JSON.parse(t.contents)}();function te(e){if(!e||!Array.isArray(e.nodes)||!Array.isArray(e.links))return{};const t=e.nodes.length,n=e.links.length,r=e.meta.languagePopularity.languageCount,a=t*(t-1)/2,i=a>0?n/a:0,o=new Map;e.links.forEach(e=>{o.set(e.source,(o.get(e.source)||0)+1),o.set(e.target,(o.get(e.target)||0)+1)});const l=Array.from(o.values()),s=l.length?l.reduce((e,t)=>e+t,0)/l.length:0,d=l.length?Math.max(...l):0,c=l.length?Math.min(...l):0,u=e?.meta?.greedyModularity;return{nodeCount:t,linkCount:n,languageCount:r,density:Number(i.toFixed(4)),avgDegree:Number(s.toFixed(2)),maxDegree:d,minDegree:c,modularity:u}}function ne(e){if(!Q)return;const t=te(e||{}),n=e=>null==e||Number.isNaN(Number(e))?"N/A":b(e),r=(e,t=2)=>Number.isFinite(e)?Number(e).toFixed(t):"N/A";Q.innerHTML=`\n      <div class="metadata-header"><strong>Metric</strong></div>\n      <div class="metadata-header"><strong>Translation Network</strong></div>\n\n      <div class="metric-label">Num. Authors</div>\n      <div class="metric-value">${n(t.nodeCount)}</div>\n\n      <div class="metric-label">Num. Shared Translations</div>\n      <div class="metric-value">${n(t.linkCount)}</div>\n\n      <div class="metric-label">Num. Languages</div>\n      <div class="metric-value">${n(t.languageCount)}</div>\n\n      <div class="metric-label">Avg. Degree</div>\n      <div class="metric-value">${r(t.avgDegree,2)}</div>\n\n      <div class="metric-label">Max degree</div>\n      <div class="metric-value">${n(t.maxDegree)}</div>\n      \n      <div class="metric-label">Min degree</div>\n      <div class="metric-value">${n(t.minDegree)}</div>\n      \n      <div class="metric-label">Density</div>\n      <div class="metric-value">${r(t.density,4)}</div>\n\n      <div class="metric-label">Modularity (Greedy)</div>\n      <div class="metric-value">${r(t.modularity,4)}</div>\n    `}te(ee),ne(ee);const re=new Map,ae=ee.nodes.map(e=>{const t={...e};T(t),t._labelNormalized=(t.label||`${t.id||""}`).trim().toLowerCase();const n=[];if(void 0!==e.id&&null!==e.id){n.push(e.id),n.push(String(e.id));const t=Number(e.id);Number.isNaN(t)||n.push(t)}return n.forEach(e=>re.set(e,t)),t}),ie=new Map,oe=ee.links.map(e=>{const t=re.get(e.source),n=re.get(e.target);if(!t||!n)return null;const r={...e,sourceNode:t,targetNode:n};return ie.set(O(t.id,n.id),r),r}).filter(Boolean),le=function(e){const t=new Map;return e.forEach(e=>{const n=e.communities||{};Object.entries(n).forEach(([e,n])=>{null==n||n<0||t.set(e,(t.get(e)||0)+1)})}),Array.from(t.entries()).sort((e,t)=>t[1]-e[1]).map(([e])=>e)}(ae)[0]||null,se=function(e){const t=Array.isArray(e?.centralityMetrics)?e.centralityMetrics:[];return t.includes("degree")?"degree":t[0]||null}(ee.meta),de=d3.extent(ae,e=>Number(e.totalWeight)||0),ce=function(e){const t=new Map;return e.forEach(e=>{e.sourceNode&&e.targetNode&&(t.has(e.sourceNode.id)||t.set(e.sourceNode.id,new Set),t.get(e.sourceNode.id).add(e.targetNode.id))}),t}(oe),ue={canvas:i,ctx:o,width:n,height:r,tooltip:l,colorScale:s,communityKey:le,centralityMetric:se,transform:d3.zoomIdentity,hoverNode:null,focusNodeId:null,focusVisible:null,selectedIds:new Set,selectionVisibleNodes:null,weightRange:null,centralizationRange:null,languageFilter:null,rings:P(n,r),baseData:ee,nodes:ae,links:oe,nodeById:re,linkByPair:ie,radiusScale:null,maxLinkWeight:1,quadtree:null,clusterFilter:new Set,clusterFilterController:null,communitySummaries:[],onlySharedSelectionLinks:!1,showEdges:!1,searchMatches:null,searchQuery:"",useTranslationOpacity:!1,translationWeightExtent:de,detailHoverConnection:null,tierFilter:new Set,legendTierRegions:[],adjacencyMap:ce,top20Filter:!1},ge=oe.map(e=>Number(e.weight||0)).filter(e=>Number.isFinite(e)&&e>0),me=e=>Number.isFinite(e)?Math.abs(e-Math.round(e))<.001?String(Math.round(e)):e.toFixed(1):e===Number.POSITIVE_INFINITY?"∞":"?",pe=e=>{if(!c)return;if(!Array.isArray(e)||2!==e.length)return void(c.textContent="Showing all connection weights.");const[t,n]=e;c.textContent=`Showing links with weights ${me(t)}–${me(n)}`},he=e=>Number.isFinite(e)?e.toFixed(3):"?",fe=e=>{if(!g)return;if(!Array.isArray(e)||2!==e.length)return void(g.textContent="Showing authors across all languageCentrality scores.");const[t,n]=e;g.textContent=`Showing authors with languageCentrality scores ${he(t)}–${he(n)}`},be=d3.extent(ge);let ye=null,xe=!1;if(d&&ge.length){const[e=1,t=1]=be,n=Math.min(t,Math.max(e,3));ye=[n,t],pe(ye),W(d,ge,{interactive:!0,initialRange:ye,onRangeChange:e=>{ye=e.slice(),pe(ye),xe&&Pe(ye)}})}else pe(ye);!ye&&be&&be.every(e=>Number.isFinite(e))&&(ye=be.slice(),pe(ye));const ve=ae.map(e=>Number(e.centralizationScoreNormalized??e.centralizationScore??Number.NaN)).filter(e=>Number.isFinite(e));let we=null,ke=!1;if(u)if(ve.length){const e=function(e=[]){if(!Array.isArray(e)||!e.length)return A();const t=e.map(e=>Number(e)).filter(e=>Number.isFinite(e)).sort((e,t)=>e-t);if(!t.length)return A();const n=e=>d3.quantileSorted(t,e),r=n(.4),a=n(.85),i={periphery:Number.isFinite(r)?r:N.periphery,core:Number.isFinite(a)?a:N.core};return i.core<=i.periphery&&(i.core=i.periphery+.01),R(i),i}(ve);R(e);const[t=0,n=1]=d3.extent(ve);if(we=[t,n],fe(we),W(u,ve,{interactive:!0,initialRange:we,onRangeChange:e=>{we=e.slice(),fe(we),ke&&function(e){Array.isArray(e)&&2===e.length?ue.centralizationRange={min:e[0],max:e[1]}:e&&Number.isFinite(e.min)&&Number.isFinite(e.max)?ue.centralizationRange={min:e.min,max:e.max}:ue.centralizationRange=null,$e(),De()}(we)}}),m){const t=d3.median(ve)??0,n=d3.mean(ve)??0,r=d3.min(ve)??0,a=d3.max(ve)??0,i=`Core ${V("core",e)} • Periphery ${V("periphery",e)} • Outer ${V("outer",e)}`;m.textContent=`Median ${t.toFixed(3)} • Mean ${n.toFixed(3)} • Range ${r.toFixed(3)}–${a.toFixed(3)}. ${i}`}}else fe(null),m&&(m.textContent="Centralization scores unavailable.");else fe(null);let Ne=[];try{Ne=await async function(e){const t=function(e){const t=new Set;return(e?.nodes||[]).forEach(e=>{(e.languages||[]).forEach(e=>{const n=F(e?.language);if(!n)return;const r=Number(e.weight);!Number.isFinite(r)||r<=0||t.add(n)})}),t}(e);["ger","mul"].forEach(e=>t.add(e));const n=e=>{if(!Array.isArray(e)||!e.length)return[];let n=e;if(t.size){const r=e.filter(e=>t.has(e.key));r.length&&(n=r)}const r=n.reduce((e,t)=>e+(Number(t.ratio)||0),0);return r>0&&Math.abs(r-1)>1e-6&&(n=n.map(e=>({...e,ratio:e.ratio/r}))),n},r=e?.meta?.languagePopularity?.ratios;if(r&&Object.keys(r).length)return n(Object.entries(r).map(([e,t])=>U(e,Number(t))).filter(Boolean));const a=await async function(){return languageRatioCache||languageRatioPromise||(languageRatioPromise=d3.csv("data.csv").then(e=>{const t=new Map;e.forEach(e=>{const n=(e.language||"").trim();n&&t.set(n,(t.get(n)||0)+1)});const n=Array.from(t.values()).reduce((e,t)=>e+t,0);return n?(languageRatioCache=Array.from(t.entries()).map(([e,t])=>({language:e,ratio:t/n})),languageRatioCache):(languageRatioCache=[],languageRatioCache)}).catch(e=>(console.error("Unable to compute language ratios from CSV",e),languageRatioCache=[],languageRatioCache)),languageRatioPromise)}();if(a.length)return n(a.map(e=>U(e.language,Number(e.ratio))).filter(Boolean));const i=new Map;(e?.nodes||[]).forEach(e=>{(e.languages||[]).forEach(e=>{if(!e?.language)return;const t=Number(e.weight);!Number.isFinite(t)||t<=0||i.set(e.language,(i.get(e.language)||0)+t)})});const o=Array.from(i.values()).reduce((e,t)=>e+t,0);return o?n(Array.from(i.entries()).map(([e,t])=>U(e,t/o)).filter(Boolean)):[]}(ee)}catch(e){console.error("Failed to compute language ratios",e),Ne=[]}if(f){const e=e=>`${(100*e).toFixed(2)}%`;if(Ne.length){const t=d3.median(Ne,e=>e.ratio)??0,n=d3.mean(Ne,e=>e.ratio)??0,r=d3.max(Ne,e=>e.ratio)??0;f.textContent=`Median ${e(t)} • Mean ${e(n)} • Max ${e(r)} • ${Ne.length} languages • Click bars to filter (Ctrl+click for multi).`}else f.textContent="Language ratio data unavailable."}const ze=(e,t={})=>{if(!e?.key)return;const n=Boolean(t.multi),r=new Set(ue.languageFilter||[]);if(n?r.has(e.key)?r.delete(e.key):r.add(e.key):1===r.size&&r.has(e.key)?r.clear():(r.clear(),r.add(e.key)),ue.languageFilter=r.size?r:null,ue.languageFilter&&ue.selectedIds.size)for(const e of Array.from(ue.selectedIds)){const t=ue.nodeById?.get(e);if(!t){ue.selectedIds.delete(e);continue}const n=T(t);let r=!1;for(const e of ue.languageFilter)if(n.has(e)){r=!0;break}r||ue.selectedIds.delete(e)}Ie(),L(ue),je(),$e(),De()},Ie=()=>{if($)try{!function(e,t,n={}){if(!e)return;const{onSelectionChange:r,selectedKeys:a}=n,i=a instanceof Set?a:new Set,o=d3.select(e);o.selectAll("*").remove(),o.on("wheel",null);const l=t.filter(e=>e.language&&Number.isFinite(e.ratio)&&e.ratio>0).sort((e,t)=>t.ratio-e.ratio).slice(0,Math.min(120,120));if(!l.length)return void o.append("div").attr("class","selection-hint").text("Language ratio bar chart unavailable.");const s=o.node(),d=Math.max(360,s?.clientWidth||s?.offsetWidth||400),c=Math.max(110,s?.clientHeight||s?.offsetHeight||130),u=16+35*l.length,g=Math.max(d,u),m=d3.scaleBand().domain(l.map(e=>e.key)).range([8,g-8]).paddingInner(0).paddingOuter(0),p=d3.scaleLinear().domain([0,d3.max(l,e=>e.ratio)||1]).range([c-36,14]),h=o.append("svg").attr("width",g).attr("height",c),f=e=>`${(100*e).toFixed(1)}%`,b=m.bandwidth()||0,y=Math.min(1,Math.max(0,b-3)),x=Math.max(3,b-y),v=(b-x)/2;h.append("g").selectAll("rect").data(l,e=>e.key).join("rect").attr("class","bar").attr("x",e=>(m(e.key)||8)+v).attr("width",x).attr("y",e=>p(e.ratio)).attr("height",e=>Math.max(2,c-36-p(e.ratio))).classed("selected",e=>i.has(e.key)).style("cursor","pointer").on("click",(e,t)=>{"function"==typeof r&&r(t,{multi:e.ctrlKey||e.metaKey,event:e})}).append("title").text(e=>`${(e.language||"n/a").toUpperCase()}: ${f(e.ratio)}`),h.append("g").selectAll("text.lang-value").data(l,e=>e.key).join("text").attr("class","lang-value").style("pointer-events","none").attr("x",e=>(m(e.key)||8)+v+x/2).attr("y",e=>Math.max(22,p(e.ratio)-4)).attr("text-anchor","middle").attr("fill","#f8fafc").attr("font-size",10).text(e=>f(e.ratio)),h.append("g").selectAll("text.lang-label").data(l,e=>e.key).join("text").attr("class","lang-label").style("pointer-events","none").attr("x",e=>(m(e.key)||8)+v+x/2).attr("y",c-36+14).attr("text-anchor","middle").attr("fill","#cbd5f5").attr("font-size",10).text(e=>(e.language||"n/a").toUpperCase())}($,Ne,{selectedKeys:ue.languageFilter,onSelectionChange:ze})}catch(e){console.error("Failed to render language ratio bar chart",e),d3.select($).selectAll("*").remove().append("div").attr("class","selection-hint").text("Language ratio bar chart failed to render.")}};Ie();const $e=()=>{const e=d3.select("#filterStatusItems");if(e.empty())return;if(e.selectAll("*").remove(),ue.languageFilter&&ue.languageFilter.size>0&&Array.from(ue.languageFilter).sort().forEach(t=>{const n=e.append("div").attr("class","filter-status-item filter-type-language");n.append("span").attr("class","filter-label").text(`Language: ${t}`),n.append("button").attr("type","button").attr("class","filter-status-item-remove").attr("aria-label","Remove language filter").attr("title","Remove this filter").text("×").on("click",()=>{ue.languageFilter.delete(t),0===ue.languageFilter.size&&(ue.languageFilter=null),Ie(),L(ue),je(),$e(),De()})}),ue.clusterFilter&&ue.clusterFilter.size>0&&Array.from(ue.clusterFilter).sort().forEach(t=>{const n=e.append("div").attr("class","filter-status-item filter-type-cluster");n.append("span").attr("class","filter-label").text(`Cluster: ${t}`),n.append("button").attr("type","button").attr("class","filter-status-item-remove").attr("aria-label","Remove cluster filter").attr("title","Remove this filter").text("×").on("click",()=>{ue.clusterFilter.delete(t),ue.clusterFilterController&&ue.clusterFilterController.toggleCluster(t),Y(ue),je(),$e(),De()})}),ue.weightRange&&(ue.weightRange.min>0||ue.weightRange.max<Number.POSITIVE_INFINITY)){const t=e.append("div").attr("class","filter-status-item filter-type-weight"),n=ue.weightRange.min.toFixed(2),r=ue.weightRange.max===Number.POSITIVE_INFINITY?"∞":ue.weightRange.max.toFixed(2);t.append("span").attr("class","filter-label").text(`Weight: ${n} - ${r}`),t.append("button").attr("type","button").attr("class","filter-status-item-remove").attr("aria-label","Remove weight filter").attr("title","Remove this filter").text("×").on("click",()=>{ue.weightRange={min:0,max:Number.POSITIVE_INFINITY},D(ue,ue.weightRange),L(ue),$e(),De()})}if(ue.centralizationRange){const t=e.append("div").attr("class","filter-status-item filter-type-languagecentrality"),n=ue.centralizationRange.min.toFixed(3),r=ue.centralizationRange.max.toFixed(3);t.append("span").attr("class","filter-label").text(`LanguageCentrality: ${n} - ${r}`),t.append("button").attr("type","button").attr("class","filter-status-item-remove").attr("aria-label","Remove centralization filter").attr("title","Remove this filter").text("×").on("click",()=>{ue.centralizationRange=null,$e(),De()})}if(ue.tierFilter&&ue.tierFilter.size>0&&Array.from(ue.tierFilter).sort().forEach(t=>{const n=e.append("div").attr("class","filter-status-item filter-type-languagecentrality"),r=z[t]||t;n.append("span").attr("class","filter-label").text(`Tier: ${r}`),n.append("button").attr("type","button").attr("class","filter-status-item-remove").attr("aria-label","Remove tier filter").attr("title","Remove this filter").text("×").on("click",()=>{ue.tierFilter.delete(t),$e(),De()})}),ue.selectedIds&&ue.selectedIds.size>0){const t=e.append("div").attr("class","filter-status-item filter-type-selection"),n=ue.selectedIds.size,r=1===n?"1 node selected":`${n} nodes selected`;t.append("span").attr("class","filter-label").text(r),t.append("button").attr("type","button").attr("class","filter-status-item-remove").attr("aria-label","Clear selection").attr("title","Clear selection").text("×").on("click",()=>{ue.selectedIds.clear(),ue.focusNodeId=null,ue.focusVisible=null,L(ue),je(),$e(),De()})}const t=[];ue.showEdges||t.push("Edges hidden"),ue.useTranslationOpacity&&t.push("Translation opacity"),ue.onlySharedSelectionLinks&&t.push("Shared links only"),ue.top20Filter&&t.push("Top 20 authors"),t.forEach(t=>{e.append("div").attr("class","filter-status-item filter-type-option").append("span").attr("class","filter-label").text(t)});const n=d3.select("#filterStatusBar"),r=ue.languageFilter?.size>0||ue.clusterFilter?.size>0||ue.weightRange&&(ue.weightRange.min>0||ue.weightRange.max<Number.POSITIVE_INFINITY)||ue.centralizationRange||ue.selectedIds?.size>0||ue.tierFilter?.size>0||!ue.showEdges||ue.useTranslationOpacity||ue.onlySharedSelectionLinks||ue.top20Filter;n.style("display",r?"flex":"none")};d3.select("#clearAllFilters").on("click",()=>{ue.languageFilter=null,ue.clusterFilter=new Set,ue.weightRange={min:0,max:Number.POSITIVE_INFINITY},ue.centralizationRange=null,ue.tierFilter=new Set,ue.selectedIds.clear(),ue.focusNodeId=null,ue.focusVisible=null,ue.top20Filter=!1,ue.clusterFilterController&&ue.clusterFilterController.clear();const e=document.getElementById("top20AuthorsBtn");e&&(e.textContent="Show Top 20 Authors",e.classList.remove("active")),Ie(),D(ue,ue.weightRange),Y(ue),L(ue),je(),$e(),De()}),$e();let Ee=null;try{Ee=await d3.json("data/language_language_graph.json"),H(Ee,{onLanguageClick:(e,t)=>{const n={key:e,language:e},r=t.ctrlKey||t.metaKey;ze(n,{multi:r})}});try{ne(ee)}catch(e){console.warn("Failed to render network metadata:",e)}}catch(e){console.warn("Could not load language-language data for chord diagram:",e)}const Ce=document.getElementById("maximizeChordBtn"),Me=document.getElementById("chordModal"),Se=document.getElementById("closeChordModal");Ce&&Me&&Se&&Ee&&(Ce.addEventListener("click",()=>{Me.style.display="flex",H(Ee,{container:"#chordDiagramLarge",width:600,height:600,onLanguageClick:(e,t)=>{const n={key:e,language:e},r=t.ctrlKey||t.metaKey;ze(n,{multi:r})}})}),Se.addEventListener("click",()=>{Me.style.display="none",d3.select("#chordDiagramLarge").selectAll("*").remove()}),Me.addEventListener("click",e=>{e.target===Me&&(Me.style.display="none",d3.select("#chordDiagramLarge").selectAll("*").remove())}),document.addEventListener("keydown",e=>{"Escape"===e.key&&"flex"===Me.style.display&&(Me.style.display="none",d3.select("#chordDiagramLarge").selectAll("*").remove())})),Ee&&K(Ee,{container:"#radialChart",width:400,height:400});const Fe=document.getElementById("maximizeRadialBtn"),Ae=document.getElementById("radialModal");if(Fe&&Ae&&Ee){const e=document.getElementById("closeRadialModal");Fe.addEventListener("click",()=>{Ae.style.display="flex",K(Ee,{container:"#radialChartZoomed",width:600,height:600})}),e&&e.addEventListener("click",()=>{Ae.style.display="none",d3.select("#radialChartZoomed").selectAll("*").remove()}),Ae.addEventListener("click",e=>{e.target===Ae&&(Ae.style.display="none",d3.select("#radialChartZoomed").selectAll("*").remove())}),document.addEventListener("keydown",e=>{"Escape"===e.key&&"flex"===Ae.style.display&&(Ae.style.display="none",d3.select("#radialChartZoomed").selectAll("*").remove())})}function Re(e){if(null==e)return null;if(re.has(e))return re.get(e);const t=Number(e);if(!Number.isNaN(t)&&re.has(t))return re.get(t);const n=String(e);return re.has(n)?re.get(n):null}function Le(e,t){if(!e||!t)return void(ue.detailHoverConnection&&(ue.detailHoverConnection=null,De()));const n=Re(e),r=Re(t);if(!n||!r)return void(ue.detailHoverConnection&&(ue.detailHoverConnection=null,De()));const a=function(e,t,n){return e?.linkByPair&&e.linkByPair.get(O(t,n))||null}(ue,n.id,r.id);ue.detailHoverConnection={sourceNode:n,targetNode:r,link:a},De()}function Te(e){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Be(e){return`${(100*(Math.max(0,Math.min(1,e))||0)).toFixed(1)}%`}function je(){if(!Z)return;Le(null);const e=Array.from(ue.selectedIds).map(e=>ue.nodeById.get(e)).filter(e=>e);0!==e.length?1!==e.length?function(e){const t=e.length,n=e.map(e=>e.label||e.id).join(", "),r=n.length>60?n.substring(0,57)+"...":n,a=e.map(t=>{const n=new Map;return ue.links.forEach(r=>{let a=null;r.sourceNode?.id===t.id?a=r.targetNode:r.targetNode?.id===t.id&&(a=r.sourceNode),a&&!e.find(e=>e.id===a.id)&&n.set(a.id,{id:a.id,label:a.label||a.id,weight:Number(r.weight)||0})}),n}),i=new Map;a.length>0&&a[0].forEach((e,t)=>{if(a.slice(1).every(e=>e.has(t))){const n=a.reduce((e,n)=>e+(n.get(t)?.weight||0),0);i.set(t,{...e,weight:n})}});const o=new Map;a.forEach(e=>{e.forEach((e,t)=>{o.has(t)?o.get(t).weight+=e.weight:o.set(t,{...e})})});const l=e.map(e=>{const t=new Map;return(e.languages||[]).forEach(e=>{const n=(e.language||"").trim(),r=Number(e.weight)||0;n&&r>0&&t.set(n,r)}),t}),s=new Map;l.length>0&&l[0].forEach((e,t)=>{if(l.slice(1).every(e=>e.has(t))){const e=l.reduce((e,n)=>e+(n.get(t)||0),0);s.set(t,e)}});const d=new Map;l.forEach(e=>{e.forEach((e,t)=>{d.has(t)?d.set(t,d.get(t)+e):d.set(t,e)})});const c=Array.from(i.values()).sort((e,t)=>t.weight-e.weight).slice(0,5),u=c.length?`<ul class="author-detail-list author-detail-connections">${c.map(e=>`<li data-connection-id="${Te(String(e.id))}" tabindex="0">\n              <strong>${Te(e.label)}</strong>\n              <span>${b(e.weight)} combined</span>\n            </li>`).join("")}</ul>`:'<p class="author-detail-empty">No shared connections found.</p>',g=Array.from(o.values()).sort((e,t)=>t.weight-e.weight).slice(0,5),m=g.length?`<ul class="author-detail-list">${g.map(e=>`<li><strong>${Te(e.label)}</strong><span>${b(e.weight)} combined</span></li>`).join("")}</ul>`:'<p class="author-detail-empty">No connections found.</p>',p=Array.from(s.entries()).sort((e,t)=>t[1]-e[1]).slice(0,5),h=p.length?`<ul class="author-detail-list">${p.map(([e,t])=>`<li><strong>${Te(e.toUpperCase())}</strong><span>${b(t)} combined</span></li>`).join("")}</ul>`:'<p class="author-detail-empty">No shared languages found.</p>',f=Array.from(d.entries()).sort((e,t)=>t[1]-e[1]).slice(0,5),y=f.length?`<ul class="author-detail-list">${f.map(([e,t])=>`<li><strong>${Te(e.toUpperCase())}</strong><span>${b(t)} combined</span></li>`).join("")}</ul>`:'<p class="author-detail-empty">No languages found.</p>',x=e.reduce((e,t)=>e+(Number(t.totalWeight)||0),0),v=e.reduce((e,t)=>{const n=Number(t.centralizationScoreNormalized);return e+(Number.isFinite(n)?n:0)},0)/e.length;Z.innerHTML=`\n      <div class="author-detail-header">\n        <div>\n          <p class="author-detail-name">${t} Authors Selected</p>\n          <p class="author-detail-meta" title="${Te(n)}">${Te(r)}</p>\n        </div>\n        <span class="author-detail-badge">Comparison</span>\n      </div>\n      <div class="author-detail-metrics">\n        <div class="author-detail-metric">\n          <span>Combined translations</span>\n          <strong>${b(x)}</strong>\n        </div>\n        <div class="author-detail-metric">\n          <span>Shared connections</span>\n          <strong>${i.size}</strong>\n        </div>\n        <div class="author-detail-metric">\n          <span>Avg. centralization</span>\n          <strong>${Number.isFinite(v)?v.toFixed(3):"n/a"}</strong>\n        </div>\n      </div>\n      <div class="author-detail-section">\n        <h3>Shared Languages (${s.size})</h3>\n        ${h}\n      </div>\n      <div class="author-detail-section">\n        <h3>All Languages (${d.size})</h3>\n        ${y}\n      </div>\n      <div class="author-detail-section">\n        <h3>Shared Connections (${i.size})</h3>\n        ${u}\n      </div>\n      <div class="author-detail-section">\n        <h3>All Connections (${o.size})</h3>\n        ${m}\n      </div>\n    `,Z.querySelectorAll(".author-detail-connections li[data-connection-id]").forEach(t=>{const n=t.getAttribute("data-connection-id");t.addEventListener("mouseenter",()=>{e.forEach(e=>Le(e.id,n))}),t.addEventListener("mouseleave",()=>Le(null)),t.addEventListener("focus",()=>{e.forEach(e=>Le(e.id,n))}),t.addEventListener("blur",()=>Le(null))})}(e):function(e){const t=Number(e.totalWeight)||0,n=(e.languages||[]).map(e=>({language:(e.language||"").trim(),weight:Number(e.weight)||0})).filter(e=>e.language&&e.weight>0).sort((e,t)=>t.weight-e.weight).slice(0,4).map(e=>{const n=t>0?e.weight/t:0;return{label:e.language.toUpperCase(),detail:`${b(e.weight)} • ${Be(n)}`}}),r=function(e,t=5){if(!e)return[];const n=[];return ue.links.forEach(t=>{let r=null;if(t.sourceNode?.id===e.id?r=t.targetNode:t.targetNode?.id===e.id&&(r=t.sourceNode),!r)return;const a=Number(t.weight)||0;a<=0||n.push({id:r.id,label:r.label||r.id,weight:a})}),n.sort((e,t)=>t.weight-e.weight||(e.label||"").localeCompare(t.label||"")).slice(0,t)}(e,5).filter(e=>void 0!==e.id&&null!==e.id).map(e=>({id:e.id,label:e.label||"n/a",detail:`${b(e.weight)} weight`})),a=(p=ue.centralityMetric)?j[p]||`${p.charAt(0).toUpperCase()}${p.slice(1)} centrality`:"Centrality",i=ue.centralityMetric?Number(e.centrality?.[ue.centralityMetric]):Number.NaN,o=Number(e.centralizationScoreNormalized),l=Number(e.centralizationScore),s=e._centralizationTier,d=z[s]||"Centrality tier",c=null!=ue.communityKey?e.communities?.[ue.communityKey]:null,u=null==c?"Unassigned community":`Community ${c}`,g=n[0]?.label||null,m=[u];var p;g?m.push(`Lead language ${g}`):(e.languages||[]).length&&m.push(`${(e.languages||[]).length} languages`);const h=m.join(" • "),f=n.length?`<ul class="author-detail-list">${n.map(e=>`<li><strong>${Te(e.label)}</strong><span>${Te(e.detail)}</span></li>`).join("")}</ul>`:'<p class="author-detail-empty">No translation breakdown available.</p>',y=r.length?`<ul class="author-detail-list author-detail-connections">${r.map(e=>`<li data-connection-id="${Te(String(e.id))}" tabindex="0"><strong>${Te(e.label)}</strong><span>${Te(e.detail)}</span></li>`).join("")}</ul>`:'<p class="author-detail-empty">No weighted connections recorded.</p>';Z.innerHTML=`\n      <div class="author-detail-header">\n        <div>\n          <p class="author-detail-name">${Te(e.label||e.id)}</p>\n          <p class="author-detail-meta">${Te(h)}</p>\n        </div>\n        <span class="author-detail-badge">${Te(d)}</span>\n      </div>\n      <div class="author-detail-metrics">\n        <div class="author-detail-metric">\n          <span>Total translations</span>\n          <strong>${b(t)}</strong>\n        </div>\n        <div class="author-detail-metric">\n          <span>${Te(a)}</span>\n          <strong>${Number.isFinite(i)?i.toFixed(3):"n/a"}</strong>\n        </div>\n        <div class="author-detail-metric">\n          <span>Centralization</span>\n          <strong>${Number.isFinite(o)?o.toFixed(3):Number.isFinite(l)?l.toFixed(3):"n/a"}</strong>\n        </div>\n      </div>\n      <div class="author-detail-section">\n        <h3>Top languages</h3>\n        ${f}\n      </div>\n      <div class="author-detail-section">\n        <h3>Strongest ties</h3>\n        ${y}\n      </div>\n    `;const x=Z.querySelectorAll(".author-detail-connections li[data-connection-id]");0===x.length?Le(null):x.forEach(t=>{const n=t.getAttribute("data-connection-id");t.addEventListener("mouseenter",()=>Le(e.id,n)),t.addEventListener("mouseleave",()=>Le(null)),t.addEventListener("focus",()=>Le(e.id,n)),t.addEventListener("blur",()=>Le(null))})}(e[0]):Z.innerHTML='<p class="author-detail-empty">Select an author to see translation stats and relationship insights.</p>'}function Pe(e){Array.isArray(e)&&2===e.length?ue.weightRange={min:e[0],max:e[1]}:e&&Number.isFinite(e.min)&&Number.isFinite(e.max)?ue.weightRange={min:e.min,max:e.max}:ue.weightRange||(ue.weightRange={min:0,max:Number.POSITIVE_INFINITY}),D(ue,ue.weightRange),L(ue),$e(),De()}function Ve(e){if(!e)return;let t=re.get(e);if(!t&&null!=e){const n=Number(e);Number.isNaN(n)||(t=re.get(n))}if(!t)return;ue.focusNodeId=e,ue.selectedIds.clear(),ue.selectedIds.add(e);const n=new Set([e]);ue.links.forEach(t=>{t.sourceNode?.id===e?n.add(t.targetNode.id):t.targetNode?.id===e&&n.add(t.sourceNode.id)}),ue.focusVisible=n,L(ue),je(),$e(),De()}je();let Oe=[];function _e(e){h&&(d3.select(h).selectAll("button").data(e,e=>e.id).join(e=>e.append("button").attr("type","button"),e=>e,e=>e.remove()).attr("data-node-id",e=>e.id).text(e=>e.label||e.id),e.length?h.classList.add("visible"):h.classList.remove("visible"))}function Ue(e){ue.searchQuery=e;const t=(e||"").trim();if(!t)return Oe=[],ue.searchMatches=null,_e([]),void De();const n=function(e,t){const n=(t||"").trim().toLowerCase();if(!n)return[];const r=[];return e.forEach(e=>{const t=(e.label||`${e.id??""}`).trim();if(!t)return;const a=t.toLowerCase(),i=a.indexOf(n);if(-1===i)return;const o=a===n?0:0===i?1:2;r.push({node:e,rank:o,weight:Number(e.totalWeight)||0,matchIndex:i,label:t})}),r.sort((e,t)=>e.rank!==t.rank?e.rank-t.rank:e.matchIndex!==t.matchIndex?e.matchIndex-t.matchIndex:e.weight!==t.weight?t.weight-e.weight:(e.label||"").localeCompare(t.label||"")),r.map(e=>e.node)}(ue.nodes,t);Oe=n;const r=n.slice(0,25);ue.searchMatches=r.length?new Set(r.map(e=>e.id)):null,_e(n.slice(0,8)),De()}function We(){ue.hoverNeighbors=ue.hoverNode&&ue.adjacencyMap?ue.adjacencyMap.get(ue.hoverNode.id)||new Set:null}function De(){const{ctx:e,width:t,height:n}=ue,r=ue.selectedIds&&ue.selectedIds.size>0,a=ue.onlySharedSelectionLinks&&ue.selectedIds.size>1,i=ue.detailHoverConnection;e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t,n),e.restore(),e.save(),e.translate(ue.transform.x,ue.transform.y),e.scale(ue.transform.k,ue.transform.k);const o=ue.transform.k||1;ue.rings.tiers.forEach(t=>{const n=I[t.tier]||"#94a3b8";e.strokeStyle=n,e.lineWidth=Math.max(2,3/o),e.setLineDash([8,4]),e.beginPath(),e.arc(ue.rings.centerX,ue.rings.centerY,t.radius,0,2*Math.PI),e.stroke()}),e.setLineDash([]);const l=[],s=ue.hoverNode?ue.hoverNode.id:null;(ue.showEdges||s)&&(ue.links.forEach(t=>{const{sourceNode:n,targetNode:i}=t;if(!n||!i)return;let d=!1;if(s&&n.id===s&&(d=!0),!Ye(ue,n)||!Ye(ue,i))return;if(!(d||ue.showEdges&&t.visible&&function(e,t){if(e.selectionVisibleNodes&&e.selectionVisibleNodes.size)return!0;if(!e.clusterFilter||0===e.clusterFilter.size)return!0;const n=B(t.sourceNode),r=B(t.targetNode);return!(!e.clusterFilter.has(n)||!e.clusterFilter.has(r))&&n===r&&function(e,t){if(!e||!t)return!1;const n=T(e),r=T(t);if(!n.size||!r.size)return!1;for(const e of n)if(r.has(e))return!0;return!1}(t.sourceNode,t.targetNode)}(ue,t)))return;let c=!1,u=!1;if(r)if(c=ue.selectedIds.has(n.id),u=ue.selectedIds.has(i.id),a){if(!c||!u)return}else if(!c&&!u)return;let g=.01+.08*Math.min(1,Math.max(.05,t.weight/ue.maxLinkWeight)),m=`rgba(255, 255, 255, ${g})`,p=!1;d?(m="#fbbf24",g=.35,p=!0):ue.hoverNode&&i.id===s?(m="#fbbf24",g=.35):ue.hoverNode&&(g=.008,m=`rgba(255,255,255,${g})`),e.strokeStyle=m;const h=d||ue.hoverNode&&i.id===s,f=p?Math.max(.8,1.5/o):(.1+1.2*Math.min(1,Math.max(.05,t.weight/ue.maxLinkWeight)))/o;e.lineWidth=ue.hoverNode&&!h?Math.max(.05,.3*f):Math.max(.1,f),e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(i.x,i.y),e.stroke(),r&&(c||u)&&l.push(t)}),l.length&&l.forEach(t=>{const{sourceNode:n,targetNode:r}=t;if(!n||!r)return;if(!Ye(ue,n)||!Ye(ue,r))return;const a=ue.selectedIds.has(n.id)&&ue.selectedIds.has(r.id);e.strokeStyle=a?"rgba(255, 255, 255, 0.8)":"rgba(255, 255, 255, 0.45)";const i=a?2.6:1.8;e.lineWidth=Math.max(.6,i/o),e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(r.x,r.y),e.stroke()})),e.font="10px 'Segoe UI', system-ui, sans-serif",e.textAlign="center",e.textBaseline="bottom";const d=ue.searchMatches&&ue.searchMatches.size>0;ue.nodes.forEach(t=>{if(!Ye(ue,t))return;const n=t._centralizationTier,r="core"===n?6.2:"periphery"===n?5.2:4.2,a=function(e){const t=e._centralizationTier;return I[t]||"#d1d5db"}(t),l=function(e,t){if(t.hoverNode)return e.id===t.hoverNode.id||t.hoverNeighbors&&t.hoverNeighbors.has(e.id)?1:.18;if(!t.useTranslationOpacity)return 1;const n=t.translationWeightExtent;if(!n||2!==n.length)return 1;const[r,a]=n;if(!Number.isFinite(r)||!Number.isFinite(a)||a<=0)return 1;const i=Math.max(1e-6,r),o=Math.max(1e-6,Number(e.totalWeight)||0),l=Math.log(i),s=Math.log(a),d=Math.max(s-l,1e-6),c=Math.log(o);return.35+.65*Math.max(0,Math.min(1,(c-l)/d))}(t,ue);e.save(),e.globalAlpha=l,e.fillStyle=a,e.beginPath(),e.arc(t.x,t.y,r,0,2*Math.PI),e.fill(),e.restore();const s=ue.focusNodeId===t.id,c=ue.hoverNode===t,u=ue.selectedIds?.has(t.id),g=d&&ue.searchMatches.has(t.id),m=i&&(i.sourceNode?.id===t.id||i.targetNode?.id===t.id),p=ue.hoverNode&&ue.hoverNeighbors&&ue.hoverNeighbors.has(t.id);if(s||c||u||g||m||p){let a=s||u||g?Math.max(1.5,3/o):Math.max(1,2/o);p&&(a=Math.max(2.5,3.5/o)),e.lineWidth=a,e.strokeStyle=u?"#22c55e":m?"#fbbf24":g?"#38bdf8":p?"#fbbf24":"core"===n?"#f8fafc":"#cbd5f5",e.beginPath(),e.arc(t.x,t.y,r+1.3,0,2*Math.PI),e.stroke()}(u||s||c||p)&&(e.fillStyle="#e5e7eb",e.fillText(t.label,t.x,t.y-r-2))}),i?.sourceNode&&i?.targetNode&&Ye(ue,i.sourceNode)&&Ye(ue,i.targetNode)&&(e.save(),e.strokeStyle="#fbbf24",e.globalAlpha=.9,e.lineWidth=Math.max(1.5,4/o),e.lineCap="round",e.lineJoin="round",e.beginPath(),e.moveTo(i.sourceNode.x,i.sourceNode.y),e.lineTo(i.targetNode.x,i.targetNode.y),e.stroke(),e.restore()),e.restore(),ue.legendTierRegions=function(e,t,n,r){if(!r.length&&!w.length)return;const a=t-16-160;let i=20;e.save(),e.translate(0,0),e.font="11px 'Segoe UI', system-ui, sans-serif",e.textBaseline="top",e.textAlign="left";const o=[];return w.length&&(i+=6,e.fillStyle="#e5e7eb",e.fillText("LanguageCentrality tiers (click to filter)",a,i),i+=14,w.forEach(t=>{const n=z[t];if(!n)return;const r=i,l=I[t];o.push({tier:t,x:a,y:r,width:150,height:14}),e.fillStyle=l,e.beginPath(),e.arc(a+6,i+6,5,0,2*Math.PI),e.fill(),e.fillStyle="#d1d5db",e.fillText(`${n} (${V(t)})`,a+16,i),i+=14}),e.fillStyle="#9ca3af",e.font="9px 'Segoe UI', system-ui, sans-serif",e.fillText("Click tier to toggle filter",a,i),e.font="11px 'Segoe UI', system-ui, sans-serif"),e.restore(),o}(e,t,0,ue.communities||[],ue.colorScale)}function Ye(e,t){if(!t.visible)return!1;if(e.top20Filter){const e=t.id||"";if(!k.includes(e))return!1}if(e.tierFilter&&e.tierFilter.size>0){const n=t._centralizationTier;if(!e.tierFilter.has(n))return!1}if(e.languageFilter&&e.languageFilter.size){const n=T(t);let r=!1;for(const t of e.languageFilter)if(n.has(t)){r=!0;break}if(!r)return!1}if(e.centralizationRange){const n=Number.isFinite(t._centralizationValue)?t._centralizationValue:S(t);if(Number.isFinite(n)&&(n<e.centralizationRange.min||n>e.centralizationRange.max))return!1}return e.selectionVisibleNodes&&e.selectionVisibleNodes.size?!!e.selectionVisibleNodes.has(t.id):(!e.clusterFilter?.size||!1!==t.clusterVisible)&&(!e.focusNodeId||e.focusVisible?.has(t.id))}function He(e){const[t,n]=d3.pointer(e,ue.canvas),r=ue.transform.k||1;return[(t-ue.transform.x)/r,(n-ue.transform.y)/r]}d3.select(i).on("mousemove",e=>{if(!ue.quadtree)return;const[t,n]=He(e),r=ue.quadtree.find(t,n,18/(ue.transform.k||1));if(r&&Ye(ue,r)){ue.hoverNode=r,We();const t=null!=r.languageCommunity?String(r.languageCommunity):"n/a";let n="",a="#64748b";"core"===r._centralizationTier?(n="Core (community 0)",a="#fbbf24"):"periphery"===r._centralizationTier?(n="Periphery (community 1/2)",a="#60a5fa"):(n="Outer (other)",a="#64748b");const i=(r.languages||[]).slice().sort((e,t)=>t.weight-e.weight).map(e=>`${e.language} <span style='color:#94a3b8'>(${e.weight})</span>`).slice(0,6).join(", ");!function(e,t,n){e.style("opacity",1).html(t).style("left",`${n.pageX+12}px`).style("top",`${n.pageY+12}px`)}(ue.tooltip,`<div style="font-size:1.08em;"><strong>${r.label}</strong></div><div style="margin:4px 0 2px 0;"><b>Total translations:</b> <span style='color:#fbbf24'>${b(r.totalWeight)}</span></div><div style="margin:2px 0 2px 0;"><b>Languages:</b> ${i||"<span style='color:#94a3b8'>n/a</span>"}</div><div style="margin:2px 0 2px 0;"><b>Community:</b> <span style='color:#38bdf8;font-weight:600;'>${t}</span></div><div style="margin:2px 0 0 0;"><b>Tier:</b> <span style='color:${a};font-weight:600;'>${n}</span></div>`,e)}else ue.hoverNode=null,We(),y(ue.tooltip);De()}).on("mouseleave",()=>{ue.hoverNode=null,We(),y(ue.tooltip),De()}).on("click",e=>{const t=i.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top;for(const e of ue.legendTierRegions)if(n>=e.x&&n<=e.x+e.width&&r>=e.y&&r<=e.y+e.height)return ue.tierFilter.has(e.tier)?ue.tierFilter.delete(e.tier):ue.tierFilter.add(e.tier),$e(),void De();if(!ue.quadtree)return;const[a,o]=He(e),l=ue.quadtree.find(a,o,18/(ue.transform.k||1));if(!l||!Ye(ue,l))return e.ctrlKey||e.metaKey||(ue.focusNodeId=null,ue.focusVisible=null,ue.selectedIds.clear(),L(ue),je(),$e()),void De();if(e.ctrlKey||e.metaKey)ue.selectedIds.has(l.id)?ue.selectedIds.delete(l.id):ue.selectedIds.add(l.id),L(ue),$e();else{ue.focusNodeId=l.id,ue.selectedIds.clear(),ue.selectedIds.add(l.id);const e=new Set([l.id]);ue.links.forEach(t=>{t.sourceNode?.id===l.id?e.add(t.targetNode.id):t.targetNode?.id===l.id&&e.add(t.sourceNode.id)}),ue.focusVisible=e,L(ue),$e()}je(),De()});const Ke=d3.zoom().scaleExtent(E).on("zoom",e=>{ue.transform=e.transform,De()});if(d3.select(i).call(Ke).call(Ke.transform,ue.transform),ue.maxLinkWeight=d3.max(ue.links,e=>e.weight)||1,ue.radiusScale=()=>7.5,_(ue.nodes,ue.rings,ue.communityKey),ue.quadtree=d3.quadtree(ue.nodes,e=>e.x,e=>e.y),ue.communities=function(e,t){const n=new Set;return e.forEach(e=>{const r=e.communities?.[t];null!=r&&r>=0&&n.add(r)}),Array.from(n).sort((e,t)=>e-t)}(ue.nodes,ue.communityKey),ue.communitySummaries=function(e){const t=new Map;return e.forEach(e=>{const n=B(e);if(null===n)return;T(e);let r=String(n);const a="0->1->2"===r,i=r.includes("->");a?r="3-bridges":i&&(r="2-bridges"),t.has(r)||t.set(r,{id:r,authorCount:0,totalLanguageWeight:0,languageCounts:new Map});const o=t.get(r);o.authorCount+=1,(e.languages||[]).forEach(e=>{const t=F(e.language);if(!t)return;const n=Number(e.weight)||1;o.totalLanguageWeight+=n;const r=o.languageCounts.get(t)||{key:t,label:(e.language||"").trim()||t,count:0};r.count+=n,o.languageCounts.set(t,r)})}),Array.from(t.values()).map(e=>{const t=Array.from(e.languageCounts.values()).sort((e,t)=>t.count-e.count).map(t=>({key:t.key,language:t.label,count:t.count,ratio:e.totalLanguageWeight?t.count/e.totalLanguageWeight:0}));return{id:e.id,authorCount:e.authorCount,languages:t,languageSet:new Set(t.map(e=>e.key))}}).sort((e,t)=>{const n=["0","1","2","2-bridges","3-bridges"],r=n.indexOf(e.id),a=n.indexOf(t.id);return-1!==r&&-1!==a?r-a:-1!==r?-1:-1!==a?1:e.id.localeCompare(t.id,void 0,{numeric:!0})})}(ue.nodes,ue.communityKey),G){const e=function(e,t,n,r){if(!e)return null;const a=d3.select(e);if(a.selectAll("*").remove(),!t.length)return a.append("div").attr("class","selection-hint").text("Community metadata unavailable."),null;const i=a.selectAll("button.cluster-filter-card").data(t,e=>e.id).join("button").attr("type","button").attr("class","cluster-filter-card").style("background",e=>{let t=e.tier||e.centralizationTier;t||"string"!=typeof e.id||(t="0"===e.id?"core":"1"===e.id||"2"===e.id?"periphery":"outer");const n=I[t]||"#d1d5db";return/^#[0-9a-fA-F]{6}$/.test(n)?`rgba(${parseInt(n.slice(1,3),16)},${parseInt(n.slice(3,5),16)},${parseInt(n.slice(5,7),16)},0.13)`:n});i.each(function(e){const t=d3.select(this);t.selectAll("*").remove();const n=t.append("div").attr("class","cluster-filter-row");let r=e.tier||e.centralizationTier;r||"string"!=typeof e.id||(r="0"===e.id?"core":"1"===e.id||"2"===e.id?"periphery":"outer");const a=I[r]||"#d1d5db";let i;i="2-bridges"===e.id?"Two-community bridges":"3-bridges"===e.id?"Three-community bridge":`Community ${e.id}`,n.append("strong").html(`<span class="cluster-filter-swatch" style="background:${a}"></span>`+i),n.append("span").text(`${e.authorCount} authors`);const o=t.append("div").attr("class","cluster-filter-languages");e.languages.length?o.selectAll("span").data(e.languages.slice(0,6)).join("span").text(e=>`${(e.language||"n/a").toUpperCase()} ${(100*e.ratio).toFixed(1)}%`):o.text("No language annotations for this community.")});let o=new Set,l=!0;const s=()=>{i.classed("selected",e=>o.has(e.id)),l?l=!1:r(new Set(o))};return i.on("click",(e,t)=>{e.preventDefault();const n=new Set(o);n.has(t.id)?n.delete(t.id):n.add(t.id),o=n,s()}),s(),{clear(){o=new Set,s()},setSelection(e){o=new Set(e),s()},getSelection:()=>new Set(o),toggleCluster(e){const t=new Set(o);t.has(e)?t.delete(e):t.add(e),o=t,s()}}}(G,ue.communitySummaries,ue.colorScale,e=>{ue.clusterFilter=e,Y(ue);const t=ue.nodes.filter(e=>!1!==e.clusterVisible);_(t,ue.rings,ue.communityKey),ue.quadtree=d3.quadtree(t,e=>e.x,e=>e.y),je(),$e(),De()});ue.clusterFilterController=e,J&&(e?J.addEventListener("click",()=>e.clear()):(J.disabled=!0,J.textContent="No filters"))}else J&&(J.style.display="none");if(we&&2===we.length?ue.centralizationRange={min:we[0],max:we[1]}:ue.centralizationRange=null,h&&h.addEventListener("mousedown",e=>{const t=e.target.closest("button[data-node-id]");t&&(e.preventDefault(),Ve(t.dataset.nodeId||t.getAttribute("data-node-id")),h.classList.remove("visible"))}),p){let e=null;p.addEventListener("input",t=>{const n=t.target.value;e&&window.clearTimeout(e),e=window.setTimeout(()=>Ue(n),150)}),p.addEventListener("keydown",e=>{if("Enter"===e.key)e.preventDefault(),Oe.length&&(Ve(Oe[0].id),h?.classList.remove("visible"));else if("Escape"===e.key){if(!p.value)return;e.preventDefault(),p.value="",Ue("")}}),p.addEventListener("focus",()=>{h&&Oe.length&&h.classList.add("visible")}),p.addEventListener("blur",()=>{setTimeout(()=>h?.classList.remove("visible"),150)})}else _e([]);Y(ue),je(),ke=!0,xe=!0,Pe(ye&&2===ye.length?ye:be&&be.every(e=>Number.isFinite(e))?be:[0,Number.POSITIVE_INFINITY]),Ue(p?.value||""),C&&C.addEventListener("click",()=>{ue.selectedIds.clear(),ue.focusNodeId=null,ue.focusVisible=null,L(ue),je(),$e(),De()}),M&&(M.checked=!1,M.addEventListener("change",()=>{ue.showEdges=Boolean(M.checked),$e(),De()})),q&&(q.checked=ue.useTranslationOpacity,q.addEventListener("change",()=>{ue.useTranslationOpacity=Boolean(q.checked),$e(),De()}));const qe=document.getElementById("top20AuthorsBtn");qe&&qe.addEventListener("click",()=>{ue.top20Filter=!ue.top20Filter,qe.textContent=ue.top20Filter?"Show All Authors":"Show Top 20 Authors",qe.classList.toggle("active",ue.top20Filter),$e(),De()});const Xe=document.getElementById("downloadPngBtn");function Ge(e,t){const n=document.getElementById(e);if(!n)return;const r=n.querySelector("svg");if(!r)return;const a=parseInt(r.getAttribute("width"))||600,i=parseInt(r.getAttribute("height"))||600,o=r.cloneNode(!0);o.querySelectorAll("text, tspan").forEach(e=>{e.setAttribute("fill","#000000"),e.style.fill="#000000"});const l=document.createElement("canvas");l.width=2*a,l.height=2*i;const s=l.getContext("2d",{alpha:!0});s.clearRect(0,0,l.width,l.height);const d=(new XMLSerializer).serializeToString(o),c=new Blob([d],{type:"image/svg+xml;charset=utf-8"}),u=URL.createObjectURL(c),g=new Image;g.onload=function(){s.scale(2,2),s.drawImage(g,0,0),URL.revokeObjectURL(u),l.toBlob(e=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},"image/png")},g.src=u}Xe&&Xe.addEventListener("click",()=>{const e=document.createElement("canvas");e.width=3*ue.canvas.width,e.height=3*ue.canvas.height;const t=e.getContext("2d");t.scale(3,3),t.drawImage(ue.canvas,0,0),t.setTransform(1,0,0,1,0,0);const n=t.getImageData(0,0,e.width,e.height),r=n.data;for(let e=0;e<r.length;e+=4){const t=r[e],n=r[e+1],a=r[e+2],i=r[e+3],o=(t+n+a)/3;if(o<50&&i>200)r[e]=255,r[e+1]=255,r[e+2]=255;else if(i>100&&o>150){const i=Math.max(t,n,a),l=Math.min(t,n,a);((i>0?(i-l)/i:0)<.3||o>200)&&(r[e]=20,r[e+1]=20,r[e+2]=20)}}t.putImageData(n,0,0);const a=t.getImageData(0,0,e.width,e.height),i=a.data,o=e.width,l=e.height,s=new Uint8ClampedArray(i);for(let e=1;e<l-1;e++)for(let t=1;t<o-1;t++){const n=4*(e*o+t),r=s[n],a=s[n+1],l=s[n+2];if(s[n+3]>150&&r<50&&a<50&&l<50&&Math.abs(r-a)<10&&Math.abs(a-l)<10)for(let n=-1;n<=1;n++)for(let r=-1;r<=1;r++){if(0===r&&0===n)continue;const a=4*((e+n)*o+(t+r)),l=s[a],d=s[a+1],c=s[a+2],u=s[a+3];l>200&&d>200&&c>200&&u>150&&(i[a]=Math.max(0,l-40),i[a+1]=Math.max(0,d-40),i[a+2]=Math.max(0,c-40))}}t.putImageData(a,0,0),e.toBlob(e=>{const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="author-network-visualization.png",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)},"image/png")}),X&&X.addEventListener("change",e=>{ue.onlySharedSelectionLinks=e.target.checked,L(ue),$e(),De()});const Je=document.getElementById("downloadChordPngBtn");Je&&Je.addEventListener("click",()=>{Ge("chordDiagramLarge","shared-authors-by-language.png")});const Ze=document.getElementById("downloadRadialPngBtn");Ze&&Ze.addEventListener("click",()=>{Ge("radialChartZoomed","target-languages-radial.png")})})().catch(e=>{console.error(e);const t=document.querySelector("main"),n=document.createElement("div");n.style.background="#fee2e2",n.style.color="#991b1b",n.style.padding="1rem",n.style.margin="1rem",n.style.borderRadius="8px",n.textContent=`Error Occurred: (${e.message})`,t.prepend(n)})})();